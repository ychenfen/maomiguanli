@echo off
chcp 65001 >nul
title çŒ«å’ªæ•‘åŠ©ç³»ç»Ÿ - æŸ¥çœ‹çŠ¶æ€
color 0B

:refresh
cls
echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                                                            â•‘
echo â•‘           ðŸ± çŒ«å’ªæ•‘åŠ©ç³»ç»Ÿ - æœåŠ¡çŠ¶æ€ç›‘æŽ§ ðŸ±              â•‘
echo â•‘                                                            â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo åˆ·æ–°æ—¶é—´: %date% %time%
echo.

:: ========== åŽç«¯æœåŠ¡çŠ¶æ€ ==========
echo â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo â”‚  åŽç«¯æœåŠ¡ (ç«¯å£: 8080)                                     â”‚
echo â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
netstat -ano | findstr ":8080" | findstr "LISTENING" >nul 2>&1
if errorlevel 1 (
    echo â”‚  çŠ¶æ€: âœ— æœªè¿è¡Œ                                           â”‚
    echo â”‚  è®¿é—®: http://localhost:8080/api                          â”‚
) else (
    for /f "tokens=5" %%a in ('netstat -ano ^| findstr ":8080" ^| findstr "LISTENING"') do (
        echo â”‚  çŠ¶æ€: âœ“ è¿è¡Œä¸­                                           â”‚
        echo â”‚  PID:   %%a                                               â”‚
        echo â”‚  è®¿é—®: http://localhost:8080/api                          â”‚
        echo â”‚  æ–‡æ¡£: http://localhost:8080/swagger-ui.html              â”‚
    )
)
echo â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.

:: ========== ç”¨æˆ·å‰ç«¯çŠ¶æ€ ==========
echo â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo â”‚  ç”¨æˆ·å‰ç«¯ (ç«¯å£: 5000)                                     â”‚
echo â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
netstat -ano | findstr ":5000" | findstr "LISTENING" >nul 2>&1
if errorlevel 1 (
    echo â”‚  çŠ¶æ€: âœ— æœªè¿è¡Œ                                           â”‚
    echo â”‚  è®¿é—®: http://localhost:5000                              â”‚
) else (
    for /f "tokens=5" %%a in ('netstat -ano ^| findstr ":5000" ^| findstr "LISTENING"') do (
        echo â”‚  çŠ¶æ€: âœ“ è¿è¡Œä¸­                                           â”‚
        echo â”‚  PID:   %%a                                               â”‚
        echo â”‚  è®¿é—®: http://localhost:5000                              â”‚
    )
)
echo â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.

:: ========== ç®¡ç†åŽå°çŠ¶æ€ ==========
echo â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo â”‚  ç®¡ç†åŽå° (ç«¯å£: 5001)                                     â”‚
echo â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
netstat -ano | findstr ":5001" | findstr "LISTENING" >nul 2>&1
if errorlevel 1 (
    echo â”‚  çŠ¶æ€: âœ— æœªè¿è¡Œ                                           â”‚
    echo â”‚  è®¿é—®: http://localhost:5001                              â”‚
) else (
    for /f "tokens=5" %%a in ('netstat -ano ^| findstr ":5001" ^| findstr "LISTENING"') do (
        echo â”‚  çŠ¶æ€: âœ“ è¿è¡Œä¸­                                           â”‚
        echo â”‚  PID:   %%a                                               â”‚
        echo â”‚  è®¿é—®: http://localhost:5001/login.html                   â”‚
    )
)
echo â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.

:: ========== æ•°æ®åº“çŠ¶æ€ ==========
echo â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo â”‚  MySQLæ•°æ®åº“ (ç«¯å£: 3306)                                  â”‚
echo â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
netstat -ano | findstr ":3306" | findstr "LISTENING" >nul 2>&1
if errorlevel 1 (
    echo â”‚  çŠ¶æ€: âœ— æœªè¿è¡Œ                                           â”‚
) else (
    for /f "tokens=5" %%a in ('netstat -ano ^| findstr ":3306" ^| findstr "LISTENING"') do (
        echo â”‚  çŠ¶æ€: âœ“ è¿è¡Œä¸­                                           â”‚
        echo â”‚  PID:   %%a                                               â”‚
    )
)
echo â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.

:: ========== ç³»ç»Ÿèµ„æº ==========
echo â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo â”‚  ç³»ç»Ÿèµ„æº                                                  â”‚
echo â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤

:: èŽ·å–Javaè¿›ç¨‹æ•°
set java_count=0
for /f %%a in ('tasklist ^| findstr /i "java.exe" ^| find /c /v ""') do set java_count=%%a
echo â”‚  Javaè¿›ç¨‹æ•°: %java_count%                                     â”‚

:: èŽ·å–Nodeè¿›ç¨‹æ•°
set node_count=0
for /f %%a in ('tasklist ^| findstr /i "node.exe" ^| find /c /v ""') do set node_count=%%a
echo â”‚  Nodeè¿›ç¨‹æ•°: %node_count%                                     â”‚

echo â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.

:: ========== æ—¥å¿—æ–‡ä»¶ ==========
echo â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo â”‚  æ—¥å¿—æ–‡ä»¶                                                  â”‚
echo â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤

if exist "backend\backend.log" (
    for %%a in ("backend\backend.log") do (
        echo â”‚  åŽç«¯æ—¥å¿—: backend\backend.log (%%~za å­—èŠ‚^)
    )
) else (
    echo â”‚  åŽç«¯æ—¥å¿—: ä¸å­˜åœ¨                                         â”‚
)

if exist "frontend\frontend.log" (
    for %%a in ("frontend\frontend.log") do (
        echo â”‚  å‰ç«¯æ—¥å¿—: frontend\frontend.log (%%~za å­—èŠ‚^)
    )
) else (
    echo â”‚  å‰ç«¯æ—¥å¿—: ä¸å­˜åœ¨                                         â”‚
)

if exist "admin-frontend\admin.log" (
    for %%a in ("admin-frontend\admin.log") do (
        echo â”‚  ç®¡ç†åŽå°æ—¥å¿—: admin-frontend\admin.log (%%~za å­—èŠ‚^)
    )
) else (
    echo â”‚  ç®¡ç†åŽå°æ—¥å¿—: ä¸å­˜åœ¨                                     â”‚
)

echo â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.

:: ========== å¿«æ·æ“ä½œ ==========
echo â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo â”‚  å¿«æ·æ“ä½œ                                                  â”‚
echo â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
echo â”‚  [1] æ‰“å¼€ç”¨æˆ·å‰ç«¯                                          â”‚
echo â”‚  [2] æ‰“å¼€ç®¡ç†åŽå°                                          â”‚
echo â”‚  [3] æ‰“å¼€APIæ–‡æ¡£                                           â”‚
echo â”‚  [4] æŸ¥çœ‹åŽç«¯æ—¥å¿—                                          â”‚
echo â”‚  [5] æŸ¥çœ‹å‰ç«¯æ—¥å¿—                                          â”‚
echo â”‚  [6] æŸ¥çœ‹ç®¡ç†åŽå°æ—¥å¿—                                      â”‚
echo â”‚  [R] åˆ·æ–°çŠ¶æ€                                              â”‚
echo â”‚  [S] åœæ­¢æ‰€æœ‰æœåŠ¡                                          â”‚
echo â”‚  [Q] é€€å‡º                                                  â”‚
echo â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.

choice /c 123456RSQ /n /m "è¯·é€‰æ‹©æ“ä½œ: "

if errorlevel 9 goto end
if errorlevel 8 goto stop_services
if errorlevel 7 goto refresh
if errorlevel 6 goto view_admin_log
if errorlevel 5 goto view_frontend_log
if errorlevel 4 goto view_backend_log
if errorlevel 3 goto open_api_doc
if errorlevel 2 goto open_admin
if errorlevel 1 goto open_frontend

:open_frontend
start http://localhost:5000
goto refresh

:open_admin
start http://localhost:5001/login.html
goto refresh

:open_api_doc
start http://localhost:8080/swagger-ui.html
goto refresh

:view_backend_log
if exist "backend\backend.log" (
    start notepad "backend\backend.log"
) else (
    echo æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨ï¼
    timeout /t 2 /nobreak >nul
)
goto refresh

:view_frontend_log
if exist "frontend\frontend.log" (
    start notepad "frontend\frontend.log"
) else (
    echo æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨ï¼
    timeout /t 2 /nobreak >nul
)
goto refresh

:view_admin_log
if exist "admin-frontend\admin.log" (
    start notepad "admin-frontend\admin.log"
) else (
    echo æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨ï¼
    timeout /t 2 /nobreak >nul
)
goto refresh

:stop_services
echo.
echo æ­£åœ¨åœæ­¢æ‰€æœ‰æœåŠ¡...
call åœæ­¢æœåŠ¡.bat
echo.
echo æ‰€æœ‰æœåŠ¡å·²åœæ­¢ï¼
timeout /t 2 /nobreak >nul
goto refresh

:end
exit
