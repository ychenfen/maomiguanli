import"./index-C7QMbvNI.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                 *//* empty css                     *//* empty css                */import{r as _,j as q,z as m,R as e,J as l,A as r,B as n,u as M,O as d,P as u,K as J,I as v,L as y,Q,a6 as X,E as Z,M as ee,W as S}from"./vue-vendor-L7KxampG.js";import{g as w,O as ae,E as p,e as te,an as oe,m as le,q as se,r as ne,I as ie,J as re,H as ce,k as de,w as ue,ad as pe,v as _e,F as fe,_ as A,X as me,s as ve,p as ye,Y as ge,ao as Ee,a8 as z}from"./element-plus-o-j_G_-z.js";import{r as Ne}from"./zh-cn-qMXBDFIZ.js";import{g as Ce,a as be,b as Te,m as he,c as L,d as Oe}from"./notification-DObBmXYi.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-CCXpdI6d.js";const Re={class:"notification-container"},Me={class:"header-content"},we={class:"header-actions"},xe={class:"stats-row"},Ie={class:"notification-list"},Se=["onClick"],Ae={class:"notification-icon"},ze={class:"notification-body"},Le={class:"notification-title"},Ve={class:"title-text"},Ue={class:"notification-content-text"},Be={class:"notification-meta"},Pe={key:0,class:"sender"},De={class:"time"},Fe={class:"notification-actions"},He={__name:"index",setup(Ge){w.extend(Ne),w.locale("zh-cn");const E=_(!1),N=_([]),C=_(0),g=_(0),b=_({}),i=_({pageNum:1,pageSize:10,type:"",isRead:null,priority:""}),c=async()=>{E.value=!0;try{const a=await Ce(i.value);a.code===200&&(N.value=a.data.records,C.value=a.data.total)}catch{p.error("加载通知失败")}finally{E.value=!1}},f=async()=>{try{const[a,t]=await Promise.all([be(),Te()]);a.code===200&&(g.value=a.data),t.code===200&&(b.value=t.data)}catch(a){console.error("加载统计信息失败",a)}},V=async a=>{try{(await L(a)).code===200&&(p.success("已标记为已读"),c(),f())}catch{p.error("操作失败")}},U=async()=>{if(g.value!==0)try{await A.confirm(`确定要将所有 ${g.value} 条未读通知标记为已读吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),(await he()).code===200&&(p.success("全部标记为已读"),c(),f())}catch(a){a!=="cancel"&&p.error("操作失败")}},B=async a=>{try{await A.confirm("确定要删除这条通知吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),(await Oe(a)).code===200&&(p.success("删除成功"),c(),f())}catch(t){t!=="cancel"&&p.error("删除失败")}},P=async a=>{a.isRead===0&&(await L(a.id),f()),console.log("跳转到相关页面",a)},D=a=>({SYSTEM:z,ADOPTION:Ee,RESCUE:ge,COMMENT:ye,LIKE:ve,DONATION:me})[a]||z,F=a=>({SYSTEM:"#909399",ADOPTION:"#409EFF",RESCUE:"#E6A23C",COMMENT:"#67C23A",LIKE:"#F56C6C",DONATION:"#409EFF"})[a]||"#909399",H=a=>({LOW:"info",NORMAL:"",HIGH:"warning",URGENT:"danger"})[a]||"",G=a=>({LOW:"低",NORMAL:"普通",HIGH:"高",URGENT:"紧急"})[a]||"",K=a=>w(a).fromNow();return q(()=>{c(),f()}),(a,t)=>{const T=te,h=le,x=ae,s=re,O=ie,k=ne,W=se,Y=ce,R=de,$=fe,j=_e;return r(),m("div",Re,[e(x,{class:"notification-header"},{default:l(()=>[n("div",Me,[t[6]||(t[6]=n("h2",null,"消息中心",-1)),n("div",we,[e(T,{type:"primary",icon:M(oe),onClick:U,disabled:g.value===0},{default:l(()=>[...t[5]||(t[5]=[d(" 全部标记为已读 ",-1)])]),_:1},8,["icon","disabled"])])]),n("div",xe,[e(h,{type:"info"},{default:l(()=>[d("全部通知: "+u(b.value.total||0),1)]),_:1}),e(h,{type:"warning"},{default:l(()=>[d("未读: "+u(b.value.unread||0),1)]),_:1})])]),_:1}),e(x,{class:"notification-content"},{default:l(()=>[e(W,{inline:!0,class:"filter-form"},{default:l(()=>[e(k,{label:"通知类型"},{default:l(()=>[e(O,{modelValue:i.value.type,"onUpdate:modelValue":t[0]||(t[0]=o=>i.value.type=o),placeholder:"全部类型",clearable:"",onChange:c},{default:l(()=>[e(s,{label:"全部",value:""}),e(s,{label:"系统通知",value:"SYSTEM"}),e(s,{label:"领养通知",value:"ADOPTION"}),e(s,{label:"救助通知",value:"RESCUE"}),e(s,{label:"评论通知",value:"COMMENT"}),e(s,{label:"点赞通知",value:"LIKE"}),e(s,{label:"捐赠通知",value:"DONATION"})]),_:1},8,["modelValue"])]),_:1}),e(k,{label:"已读状态"},{default:l(()=>[e(O,{modelValue:i.value.isRead,"onUpdate:modelValue":t[1]||(t[1]=o=>i.value.isRead=o),placeholder:"全部状态",clearable:"",onChange:c},{default:l(()=>[e(s,{label:"全部",value:null}),e(s,{label:"未读",value:0}),e(s,{label:"已读",value:1})]),_:1},8,["modelValue"])]),_:1}),e(k,{label:"优先级"},{default:l(()=>[e(O,{modelValue:i.value.priority,"onUpdate:modelValue":t[2]||(t[2]=o=>i.value.priority=o),placeholder:"全部优先级",clearable:"",onChange:c},{default:l(()=>[e(s,{label:"全部",value:""}),e(s,{label:"低",value:"LOW"}),e(s,{label:"普通",value:"NORMAL"}),e(s,{label:"高",value:"HIGH"}),e(s,{label:"紧急",value:"URGENT"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),J((r(),m("div",Ie,[N.value.length===0?(r(),v(Y,{key:0,description:"暂无通知"})):y("",!0),(r(!0),m(Q,null,X(N.value,o=>(r(),m("div",{key:o.id,class:Z(["notification-item",{"is-unread":o.isRead===0}]),onClick:I=>P(o)},[n("div",Ae,[e(R,{size:24,color:F(o.type)},{default:l(()=>[(r(),v(ee(D(o.type))))]),_:2},1032,["color"])]),n("div",ze,[n("div",Le,[n("span",Ve,u(o.title),1),o.priority!=="NORMAL"?(r(),v(h,{key:0,type:H(o.priority),size:"small"},{default:l(()=>[d(u(G(o.priority)),1)]),_:2},1032,["type"])):y("",!0)]),n("div",Ue,u(o.content),1),n("div",Be,[o.senderName?(r(),m("span",Pe,[e(R,null,{default:l(()=>[e(M(ue))]),_:1}),d(" "+u(o.senderName),1)])):y("",!0),n("span",De,[e(R,null,{default:l(()=>[e(M(pe))]),_:1}),d(" "+u(K(o.createTime)),1)])])]),n("div",Fe,[o.isRead===0?(r(),v(T,{key:0,size:"small",onClick:S(I=>V(o.id),["stop"])},{default:l(()=>[...t[7]||(t[7]=[d(" 标记已读 ",-1)])]),_:1},8,["onClick"])):y("",!0),e(T,{size:"small",type:"danger",plain:"",onClick:S(I=>B(o.id),["stop"])},{default:l(()=>[...t[8]||(t[8]=[d(" 删除 ",-1)])]),_:1},8,["onClick"])])],10,Se))),128))])),[[j,E.value]]),C.value>0?(r(),v($,{key:0,class:"pagination","current-page":i.value.pageNum,"onUpdate:currentPage":t[3]||(t[3]=o=>i.value.pageNum=o),"page-size":i.value.pageSize,"onUpdate:pageSize":t[4]||(t[4]=o=>i.value.pageSize=o),"page-sizes":[10,20,50,100],total:C.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:c,onCurrentChange:c},null,8,["current-page","page-size","total"])):y("",!0)]),_:1})])}}},sa=ke(He,[["__scopeId","data-v-01e7d1d7"]]);export{sa as default};
