import{s as b}from"./index-BCcbQRi_.js";/* empty css                   *//* empty css                   *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css               *//* empty css                  */import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{O as K,$ as G,E as u,aD as Q,aE as W,m as X,e as Z,v as ee,I as le,J as ae,q as te,r as oe,u as re,aI as ne,aH as se,_ as I}from"./element-plus-o-j_G_-z.js";import{r as d,j as ie,z as ue,R as l,J as t,A as R,K as de,I as pe,O as p,P as V,B as f,D as ce}from"./vue-vendor-L7KxampG.js";import"./utils-CCXpdI6d.js";function me(n){return b.get("/api/cat-tags",{params:{type:n}})}function ve(n){return b.post("/api/cat-tags",n)}function fe(n,c){return b.put(`/api/cat-tags/${n}`,c)}function ge(n){return b.delete(`/api/cat-tags/${n}`)}function _e(n,c){return b.put(`/api/cat-tags/${n}/toggle`,null,{params:{active:c}})}const ye={class:"cat-tag-manage"},Te={class:"card-header"},be={class:"header-actions"},Ve={style:{display:"flex","align-items":"center"}},Ce={__name:"cat-tags",setup(n){const c=d(!1),C=d(!1),E=d([]),g=d(""),m=d(!1),w=d("添加标签"),_=d(null),r=d({id:null,name:"",type:"",color:"#409EFF",sortOrder:0,description:""}),S={name:[{required:!0,message:"请输入标签名称",trigger:"blur"}],type:[{required:!0,message:"请选择标签类型",trigger:"change"}],color:[{required:!0,message:"请选择颜色",trigger:"change"}]},$=o=>({ACTIVITY:"活动标签",STATUS:"状态标签",CHARACTER:"性格标签"})[o]||o,U=o=>({ACTIVITY:"primary",STATUS:"success",CHARACTER:"warning"})[o]||"info",y=async()=>{c.value=!0;try{const o=await me(g.value);o.code===200&&(g.value?E.value=o.data[g.value.toLowerCase()]||[]:E.value=[...o.data.activity||[],...o.data.status||[],...o.data.character||[]])}catch{u.error("加载数据失败")}finally{c.value=!1}},F=()=>{w.value="添加标签",m.value=!0},D=o=>{w.value="编辑标签",r.value={...o},m.value=!0},O=async()=>{_.value&&await _.value.validate(async o=>{if(o){C.value=!0;try{r.value.id?(await fe(r.value.id,r.value),u.success("更新成功")):(await ve(r.value),u.success("添加成功")),m.value=!1,y()}catch{u.error(r.value.id?"更新失败":"添加失败")}finally{C.value=!1}}})},B=async o=>{const e=o.active?"禁用":"启用";try{await I.confirm(`确定要${e}标签 "${o.name}" 吗？`,"提示",{type:"warning"}),await _e(o.id,!o.active),u.success(`${e}成功`),y()}catch(s){s!=="cancel"&&u.error(`${e}失败`)}},z=async o=>{try{await I.confirm(`确定要删除标签 "${o.name}" 吗？此操作不可恢复！`,"警告",{type:"warning",confirmButtonText:"确定删除"}),await ge(o.id),u.success("删除成功"),y()}catch(e){e!=="cancel"&&u.error("删除失败")}},H=()=>{r.value={id:null,name:"",type:"",color:"#409EFF",sortOrder:0,description:""},_.value&&_.value.resetFields()};return ie(()=>{y()}),(o,e)=>{const s=ae,k=le,v=Z,i=W,A=X,q=Q,N=K,x=re,T=oe,Y=ne,L=se,M=te,J=G,P=ee;return R(),ue("div",ye,[l(N,null,{header:t(()=>[f("div",Te,[e[10]||(e[10]=f("span",null,"标签管理",-1)),f("div",be,[l(k,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),placeholder:"标签类型",style:{width:"150px"},clearable:"",onChange:y},{default:t(()=>[l(s,{label:"活动标签",value:"ACTIVITY"}),l(s,{label:"状态标签",value:"STATUS"}),l(s,{label:"性格标签",value:"CHARACTER"})]),_:1},8,["modelValue"]),l(v,{type:"primary",onClick:F,style:{"margin-left":"10px"}},{default:t(()=>[...e[9]||(e[9]=[p(" 添加标签 ",-1)])]),_:1})])])]),default:t(()=>[de((R(),pe(q,{data:E.value,style:{width:"100%"}},{default:t(()=>[l(i,{prop:"id",label:"ID",width:"60"}),l(i,{prop:"name",label:"标签名称",width:"150"}),l(i,{prop:"type",label:"标签类型",width:"120"},{default:t(({row:a})=>[l(A,{type:U(a.type)},{default:t(()=>[p(V($(a.type)),1)]),_:2},1032,["type"])]),_:1}),l(i,{prop:"color",label:"颜色",width:"100"},{default:t(({row:a})=>[f("div",Ve,[f("div",{style:ce({width:"20px",height:"20px",backgroundColor:a.color,borderRadius:"4px",marginRight:"8px"})},null,4),f("span",null,V(a.color),1)])]),_:1}),l(i,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""}),l(i,{prop:"active",label:"状态",width:"80"},{default:t(({row:a})=>[l(A,{type:a.active?"success":"danger"},{default:t(()=>[p(V(a.active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(i,{prop:"sortOrder",label:"排序",width:"80"}),l(i,{label:"操作",fixed:"right",width:"180"},{default:t(({row:a})=>[l(v,{type:"primary",link:"",size:"small",onClick:h=>D(a)},{default:t(()=>[...e[11]||(e[11]=[p(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(v,{type:a.active?"danger":"success",link:"",size:"small",onClick:h=>B(a)},{default:t(()=>[p(V(a.active?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),l(v,{type:"danger",link:"",size:"small",onClick:h=>z(a)},{default:t(()=>[...e[12]||(e[12]=[p(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[P,c.value]])]),_:1}),l(J,{modelValue:m.value,"onUpdate:modelValue":e[8]||(e[8]=a=>m.value=a),title:w.value,width:"500px",onClose:H},{footer:t(()=>[l(v,{onClick:e[7]||(e[7]=a=>m.value=!1)},{default:t(()=>[...e[13]||(e[13]=[p("取消",-1)])]),_:1}),l(v,{type:"primary",onClick:O,loading:C.value},{default:t(()=>[...e[14]||(e[14]=[p(" 确定 ",-1)])]),_:1},8,["loading"])]),default:t(()=>[l(M,{ref_key:"formRef",ref:_,model:r.value,rules:S,"label-width":"100px"},{default:t(()=>[l(T,{label:"标签名称",prop:"name"},{default:t(()=>[l(x,{modelValue:r.value.name,"onUpdate:modelValue":e[1]||(e[1]=a=>r.value.name=a),placeholder:"请输入标签名称"},null,8,["modelValue"])]),_:1}),l(T,{label:"标签类型",prop:"type"},{default:t(()=>[l(k,{modelValue:r.value.type,"onUpdate:modelValue":e[2]||(e[2]=a=>r.value.type=a),placeholder:"请选择标签类型",style:{width:"100%"}},{default:t(()=>[l(s,{label:"活动标签",value:"ACTIVITY"}),l(s,{label:"状态标签",value:"STATUS"}),l(s,{label:"性格标签",value:"CHARACTER"})]),_:1},8,["modelValue"])]),_:1}),l(T,{label:"颜色",prop:"color"},{default:t(()=>[l(Y,{modelValue:r.value.color,"onUpdate:modelValue":e[3]||(e[3]=a=>r.value.color=a)},null,8,["modelValue"]),l(x,{modelValue:r.value.color,"onUpdate:modelValue":e[4]||(e[4]=a=>r.value.color=a),placeholder:"#409EFF",style:{width:"200px","margin-left":"10px"}},null,8,["modelValue"])]),_:1}),l(T,{label:"排序",prop:"sortOrder"},{default:t(()=>[l(L,{modelValue:r.value.sortOrder,"onUpdate:modelValue":e[5]||(e[5]=a=>r.value.sortOrder=a),min:0,max:999,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(T,{label:"描述",prop:"description"},{default:t(()=>[l(x,{modelValue:r.value.description,"onUpdate:modelValue":e[6]||(e[6]=a=>r.value.description=a),type:"textarea",rows:3,placeholder:"请输入标签描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},He=j(Ce,[["__scopeId","data-v-f476610b"]]);export{He as default};
