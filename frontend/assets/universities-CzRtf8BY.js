import{s as y}from"./index-C7QMbvNI.js";/* empty css                   *//* empty css                   *//* empty css                     *//* empty css                *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";import{r,j as te,z as $,R as a,J as o,A as b,K as oe,I as z,O as f,P as q,B,a4 as ne,u as re,Q as K,a6 as R}from"./vue-vendor-L7KxampG.js";import{O as se,$ as ie,E as v,aD as ue,aE as de,m as pe,e as ve,v as ce,F as me,u as fe,K as ye,I as ge,J as _e,q as be,r as Ve,_ as L}from"./element-plus-o-j_G_-z.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-CCXpdI6d.js";function xe(s){return y.get("/api/university/page",{params:s})}function Ce(s){return y.post("/api/university",s)}function ke(s,c){return y.put(`/api/university/${s}`,c)}function Ee(s){return y.delete(`/api/university/${s}`)}function Ue(s,c){return y.put(`/api/university/${s}/status`,null,{params:{status:c}})}function he(){return y.get("/api/university/provinces")}function $e(s){return y.get("/api/university/cities",{params:{province:s}})}const ze={class:"university-manage"},Be={class:"card-header"},De={class:"header-actions"},Fe={__name:"universities",setup(s){const c=r(!1),x=r(!1),D=r([]),C=r(""),g=r(""),w=r(""),k=r(1),E=r(10),F=r(0),P=r([]),U=r([]),_=r(!1),h=r("添加高校"),V=r(null),n=r({id:null,name:"",province:"",city:"",address:"",phone:"",website:"",description:""}),M={name:[{required:!0,message:"请输入高校名称",trigger:"blur"}],province:[{required:!0,message:"请输入省份",trigger:"blur"}],city:[{required:!0,message:"请输入城市",trigger:"blur"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}]},i=async()=>{c.value=!0;try{const t=await xe({page:k.value,pageSize:E.value,keyword:C.value,province:g.value,city:w.value});t.code===200&&(D.value=t.data.records||[],F.value=t.data.total||0)}catch{v.error("加载数据失败")}finally{c.value=!1}},N=async()=>{try{const t=await he();t.code===200&&(P.value=t.data||[])}catch(t){console.error("加载省份失败",t)}},O=async()=>{if(w.value="",U.value=[],g.value)try{const t=await $e(g.value);t.code===200&&(U.value=t.data||[])}catch(t){console.error("加载城市失败",t)}i()},j=()=>{h.value="添加高校",_.value=!0},A=t=>{h.value="编辑高校",n.value={...t},_.value=!0},J=async()=>{V.value&&await V.value.validate(async t=>{if(t){x.value=!0;try{n.value.id?(await ke(n.value.id,n.value),v.success("更新成功")):(await Ce(n.value),v.success("添加成功")),_.value=!1,i()}catch{v.error(n.value.id?"更新失败":"添加失败")}finally{x.value=!1}}})},Q=async t=>{const e=t.status===1?"禁用":"启用";try{await L.confirm(`确定要${e}高校 "${t.name}" 吗？`,"提示",{type:"warning"}),await Ue(t.id,t.status===1?0:1),v.success(`${e}成功`),i()}catch(u){u!=="cancel"&&v.error(`${e}失败`)}},G=async t=>{try{await L.confirm(`确定要删除高校 "${t.name}" 吗？此操作不可恢复！`,"警告",{type:"warning",confirmButtonText:"确定删除"}),await Ee(t.id),v.success("删除成功"),i()}catch(e){e!=="cancel"&&v.error("删除失败")}},H=()=>{n.value={id:null,name:"",province:"",city:"",address:"",phone:"",website:"",description:""},V.value&&V.value.resetFields()};return te(()=>{i(),N()}),(t,e)=>{const u=ve,d=fe,S=_e,T=ge,p=de,W=pe,X=ue,Y=me,Z=se,m=Ve,ee=be,le=ie,ae=ce;return b(),$("div",ze,[a(Z,null,{header:o(()=>[B("div",Be,[e[15]||(e[15]=B("span",null,"高校管理",-1)),B("div",De,[a(d,{modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=l=>C.value=l),placeholder:"搜索高校名称",style:{width:"200px"},clearable:"",onClear:i,onKeyup:ne(i,["enter"])},{append:o(()=>[a(u,{icon:re(ye),onClick:i},null,8,["icon"])]),_:1},8,["modelValue"]),a(T,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=l=>g.value=l),placeholder:"省份筛选",style:{width:"150px","margin-left":"10px"},clearable:"",onChange:O},{default:o(()=>[(b(!0),$(K,null,R(P.value,l=>(b(),z(S,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(T,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=l=>w.value=l),placeholder:"城市筛选",style:{width:"150px","margin-left":"10px"},clearable:"",onChange:i,disabled:!g.value},{default:o(()=>[(b(!0),$(K,null,R(U.value,l=>(b(),z(S,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]),a(u,{type:"primary",onClick:j,style:{"margin-left":"10px"}},{default:o(()=>[...e[14]||(e[14]=[f(" 添加高校 ",-1)])]),_:1})])])]),default:o(()=>[oe((b(),z(X,{data:D.value,style:{width:"100%"}},{default:o(()=>[a(p,{prop:"id",label:"ID",width:"60"}),a(p,{prop:"name",label:"高校名称","min-width":"200"}),a(p,{prop:"province",label:"省份",width:"120"}),a(p,{prop:"city",label:"城市",width:"120"}),a(p,{prop:"address",label:"地址","min-width":"200","show-overflow-tooltip":""}),a(p,{prop:"status",label:"状态",width:"80"},{default:o(({row:l})=>[a(W,{type:l.status===1?"success":"danger"},{default:o(()=>[f(q(l.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),a(p,{prop:"createTime",label:"创建时间",width:"160"}),a(p,{label:"操作",fixed:"right",width:"200"},{default:o(({row:l})=>[a(u,{type:"primary",link:"",size:"small",onClick:I=>A(l)},{default:o(()=>[...e[16]||(e[16]=[f(" 编辑 ",-1)])]),_:1},8,["onClick"]),a(u,{type:l.status===1?"danger":"success",link:"",size:"small",onClick:I=>Q(l)},{default:o(()=>[f(q(l.status===1?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),a(u,{type:"danger",link:"",size:"small",onClick:I=>G(l)},{default:o(()=>[...e[17]||(e[17]=[f(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ae,c.value]]),a(Y,{"current-page":k.value,"onUpdate:currentPage":e[3]||(e[3]=l=>k.value=l),"page-size":E.value,"onUpdate:pageSize":e[4]||(e[4]=l=>E.value=l),total:F.value,layout:"total, prev, pager, next",style:{"margin-top":"20px","justify-content":"flex-end"},onCurrentChange:i},null,8,["current-page","page-size","total"])]),_:1}),a(le,{modelValue:_.value,"onUpdate:modelValue":e[13]||(e[13]=l=>_.value=l),title:h.value,width:"600px",onClose:H},{footer:o(()=>[a(u,{onClick:e[12]||(e[12]=l=>_.value=!1)},{default:o(()=>[...e[18]||(e[18]=[f("取消",-1)])]),_:1}),a(u,{type:"primary",onClick:J,loading:x.value},{default:o(()=>[...e[19]||(e[19]=[f(" 确定 ",-1)])]),_:1},8,["loading"])]),default:o(()=>[a(ee,{ref_key:"formRef",ref:V,model:n.value,rules:M,"label-width":"100px"},{default:o(()=>[a(m,{label:"高校名称",prop:"name"},{default:o(()=>[a(d,{modelValue:n.value.name,"onUpdate:modelValue":e[5]||(e[5]=l=>n.value.name=l),placeholder:"请输入高校名称"},null,8,["modelValue"])]),_:1}),a(m,{label:"省份",prop:"province"},{default:o(()=>[a(d,{modelValue:n.value.province,"onUpdate:modelValue":e[6]||(e[6]=l=>n.value.province=l),placeholder:"请输入省份"},null,8,["modelValue"])]),_:1}),a(m,{label:"城市",prop:"city"},{default:o(()=>[a(d,{modelValue:n.value.city,"onUpdate:modelValue":e[7]||(e[7]=l=>n.value.city=l),placeholder:"请输入城市"},null,8,["modelValue"])]),_:1}),a(m,{label:"地址",prop:"address"},{default:o(()=>[a(d,{modelValue:n.value.address,"onUpdate:modelValue":e[8]||(e[8]=l=>n.value.address=l),type:"textarea",rows:3,placeholder:"请输入详细地址"},null,8,["modelValue"])]),_:1}),a(m,{label:"联系电话",prop:"phone"},{default:o(()=>[a(d,{modelValue:n.value.phone,"onUpdate:modelValue":e[9]||(e[9]=l=>n.value.phone=l),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),a(m,{label:"网站",prop:"website"},{default:o(()=>[a(d,{modelValue:n.value.website,"onUpdate:modelValue":e[10]||(e[10]=l=>n.value.website=l),placeholder:"请输入官方网站"},null,8,["modelValue"])]),_:1}),a(m,{label:"描述",prop:"description"},{default:o(()=>[a(d,{modelValue:n.value.description,"onUpdate:modelValue":e[11]||(e[11]=l=>n.value.description=l),type:"textarea",rows:3,placeholder:"请输入高校描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},He=we(Fe,[["__scopeId","data-v-3f421c15"]]);export{He as default};
