import"./index-DnjN8ieL.js";/* empty css                   *//* empty css                   *//* empty css                             *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                *//* empty css                        *//* empty css                 *//* empty css                       *//* empty css                 *//* empty css                        */import{r as E,l as G,j as te,z as _,B as n,R as l,K as ae,J as a,I as v,L as d,Q as se,a6 as le,aA as oe,A as u,O as o,P as r,E as ne}from"./vue-vendor-L7KxampG.js";import{g as ie,c as re}from"./adoption-DdVNeMZk.js";import{D as ue,v as de,F as ce,$ as pe,E as A,H as me,M as ve,a0 as _e,e as ge,Q as fe,m as Ee,O as ye,T as Ce,U as De,g as ke,_ as be}from"./element-plus-o-j_G_-z.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-CCXpdI6d.js";const ze={class:"my-applications-page"},Ne={class:"container"},Pe={class:"filter-bar"},Te={class:"applications-list"},Ae={key:1,class:"application-cards"},Ve={class:"card-content"},Ie=["onClick"],Re={class:"cat-image"},Le={class:"cat-info"},$e={class:"cat-meta"},xe={class:"age"},Be={class:"application-section"},Me={class:"info-row"},Ge={class:"value"},Se={class:"info-row"},je={key:0,class:"info-row"},Je={class:"value"},Oe={key:1,class:"info-row"},Ue={class:"value comment"},Fe={class:"actions-section"},Ye={key:2,class:"pagination-wrapper"},He={key:0,class:"detail-content"},he={__name:"my",setup(Qe){const V=oe(),k=E(!1),b=E(""),c=G({page:1,size:10}),N=E([]),P=E(0),g=G({pending:0,approved:0,rejected:0,cancelled:0}),y=E(!1),i=E(null),C=async()=>{k.value=!0;try{const s={page:c.page,size:c.size};b.value&&(s.status=b.value);const e=await ie(s);e.code===200&&(N.value=e.data.records||[],P.value=e.data.total||0,e.data.statusCount&&(g.pending=e.data.statusCount.PENDING||0,g.approved=e.data.statusCount.APPROVED||0,g.rejected=e.data.statusCount.REJECTED||0,g.cancelled=e.data.statusCount.CANCELLED||0))}catch{A.error("加载申请列表失败")}finally{k.value=!1}},S=()=>{c.page=1,C()},j=s=>{c.page=s,C()},J=s=>{c.size=s,c.page=1,C()},O=s=>{i.value=s,y.value=!0},I=async s=>{try{await be.confirm("确定要取消这个领养申请吗？取消后无法恢复。","取消确认",{confirmButtonText:"确定取消",cancelButtonText:"再想想",type:"warning"}),(await re(s)).code===200&&(A.success("申请已取消"),C())}catch(e){e!=="cancel"&&A.error(e.message||"取消申请失败")}},U=async()=>{await I(i.value.id),y.value=!1},F=s=>{V.push(`/adoption/apply/${s}`)},Y=s=>{V.push(`/cats/${s}`)},R=s=>({PENDING:"待审核",APPROVED:"已通过",REJECTED:"已拒绝",CANCELLED:"已取消"})[s]||s,L=s=>({PENDING:"warning",APPROVED:"success",REJECTED:"danger",CANCELLED:"info"})[s]||"info",w=s=>s?ke(s).format("YYYY-MM-DD HH:mm:ss"):"-";return te(()=>{C()}),(s,e)=>{const D=ve,H=_e,h=ue,f=ge,Q=me,K=fe,z=Ee,q=ye,W=ce,p=De,X=Ce,Z=pe,ee=de;return u(),_("div",ze,[n("div",Ne,[e[19]||(e[19]=n("div",{class:"page-header"},[n("h1",null,"我的领养申请"),n("p",{class:"desc"},"查看和管理您提交的领养申请")],-1)),n("div",Pe,[l(h,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=t=>b.value=t),onChange:S},{default:a(()=>[l(D,{label:""},{default:a(()=>[...e[6]||(e[6]=[o("全部",-1)])]),_:1}),l(D,{label:"PENDING"},{default:a(()=>[e[7]||(e[7]=o(" 待审核 ",-1)),g.pending>0?(u(),v(H,{key:0,value:g.pending,class:"badge"},null,8,["value"])):d("",!0)]),_:1}),l(D,{label:"APPROVED"},{default:a(()=>[...e[8]||(e[8]=[o("已通过",-1)])]),_:1}),l(D,{label:"REJECTED"},{default:a(()=>[...e[9]||(e[9]=[o("已拒绝",-1)])]),_:1}),l(D,{label:"CANCELLED"},{default:a(()=>[...e[10]||(e[10]=[o("已取消",-1)])]),_:1})]),_:1},8,["modelValue"])]),ae((u(),_("div",Te,[!k.value&&N.value.length===0?(u(),v(Q,{key:0,description:"暂无申请记录"},{default:a(()=>[l(f,{type:"primary",onClick:e[1]||(e[1]=t=>s.$router.push("/cats"))},{default:a(()=>[...e[11]||(e[11]=[o(" 去看看猫咪 ",-1)])]),_:1})]),_:1})):(u(),_("div",Ae,[(u(!0),_(se,null,le(N.value,t=>(u(),v(q,{key:t.id,class:ne(["application-card",`status-${t.status.toLowerCase()}`])},{default:a(()=>{var T,$,x,B,M;return[n("div",Ve,[n("div",{class:"cat-section",onClick:m=>Y(t.catId)},[n("div",Re,[l(K,{src:((T=t.cat)==null?void 0:T.coverImage)||"/placeholder-cat.jpg",fit:"cover",alt:($=t.cat)==null?void 0:$.name},null,8,["src","alt"])]),n("div",Le,[n("h3",null,r((x=t.cat)==null?void 0:x.name),1),n("div",$e,[l(z,{size:"small",type:"info"},{default:a(()=>{var m;return[o(r(((m=t.cat)==null?void 0:m.breed)||"中华田园猫"),1)]}),_:2},1024),l(z,{size:"small",type:((B=t.cat)==null?void 0:B.gender)===1?"primary":"danger"},{default:a(()=>{var m;return[o(r(((m=t.cat)==null?void 0:m.gender)===1?"公":"母"),1)]}),_:2},1032,["type"]),n("span",xe,r(((M=t.cat)==null?void 0:M.age)||"年龄未知"),1)])])],8,Ie),n("div",Be,[n("div",Me,[e[12]||(e[12]=n("span",{class:"label"},"申请时间：",-1)),n("span",Ge,r(w(t.createTime)),1)]),n("div",Se,[e[13]||(e[13]=n("span",{class:"label"},"申请状态：",-1)),l(z,{type:L(t.status),size:"small"},{default:a(()=>[o(r(R(t.status)),1)]),_:2},1032,["type"])]),t.reviewTime?(u(),_("div",je,[e[14]||(e[14]=n("span",{class:"label"},"审核时间：",-1)),n("span",Je,r(w(t.reviewTime)),1)])):d("",!0),t.reviewComment?(u(),_("div",Oe,[e[15]||(e[15]=n("span",{class:"label"},"审核意见：",-1)),n("span",Ue,r(t.reviewComment),1)])):d("",!0)]),n("div",Fe,[l(f,{type:"primary",plain:"",size:"small",onClick:m=>O(t)},{default:a(()=>[...e[16]||(e[16]=[o(" 查看详情 ",-1)])]),_:1},8,["onClick"]),t.status==="PENDING"?(u(),v(f,{key:0,type:"danger",plain:"",size:"small",onClick:m=>I(t.id)},{default:a(()=>[...e[17]||(e[17]=[o(" 取消申请 ",-1)])]),_:1},8,["onClick"])):d("",!0),t.status==="REJECTED"?(u(),v(f,{key:1,type:"warning",plain:"",size:"small",onClick:m=>F(t.catId)},{default:a(()=>[...e[18]||(e[18]=[o(" 重新申请 ",-1)])]),_:1},8,["onClick"])):d("",!0)])])]}),_:2},1032,["class"]))),128))])),P.value>0?(u(),_("div",Ye,[l(W,{"current-page":c.page,"onUpdate:currentPage":e[2]||(e[2]=t=>c.page=t),"page-size":c.size,"onUpdate:pageSize":e[3]||(e[3]=t=>c.size=t),total:P.value,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:J,onCurrentChange:j},null,8,["current-page","page-size","total"])])):d("",!0)])),[[ee,k.value]])]),l(Z,{modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=t=>y.value=t),title:"申请详情",width:"600px","close-on-click-modal":!1},{footer:a(()=>{var t;return[l(f,{onClick:e[4]||(e[4]=T=>y.value=!1)},{default:a(()=>[...e[20]||(e[20]=[o("关闭",-1)])]),_:1}),((t=i.value)==null?void 0:t.status)==="PENDING"?(u(),v(f,{key:0,type:"danger",onClick:U},{default:a(()=>[...e[21]||(e[21]=[o(" 取消申请 ",-1)])]),_:1})):d("",!0)]}),default:a(()=>[i.value?(u(),_("div",He,[l(X,{column:1,border:""},{default:a(()=>[l(p,{label:"领养理由"},{default:a(()=>[o(r(i.value.reason),1)]),_:1}),l(p,{label:"居住条件"},{default:a(()=>[o(r(i.value.livingCondition),1)]),_:1}),l(p,{label:"养猫经验"},{default:a(()=>[o(r(i.value.experience),1)]),_:1}),l(p,{label:"联系电话"},{default:a(()=>[o(r(i.value.contactPhone),1)]),_:1}),l(p,{label:"联系地址"},{default:a(()=>[o(r(i.value.contactAddress),1)]),_:1}),l(p,{label:"申请时间"},{default:a(()=>[o(r(w(i.value.createTime)),1)]),_:1}),l(p,{label:"申请状态"},{default:a(()=>[l(z,{type:L(i.value.status)},{default:a(()=>[o(r(R(i.value.status)),1)]),_:1},8,["type"])]),_:1}),i.value.reviewTime?(u(),v(p,{key:0,label:"审核时间"},{default:a(()=>[o(r(w(i.value.reviewTime)),1)]),_:1})):d("",!0),i.value.reviewer?(u(),v(p,{key:1,label:"审核人"},{default:a(()=>[o(r(i.value.reviewer),1)]),_:1})):d("",!0),i.value.reviewComment?(u(),v(p,{key:2,label:"审核意见"},{default:a(()=>[o(r(i.value.reviewComment),1)]),_:1})):d("",!0)]),_:1})])):d("",!0)]),_:1},8,["modelValue"])])}}},vt=we(he,[["__scopeId","data-v-c0ee10d4"]]);export{vt as default};
