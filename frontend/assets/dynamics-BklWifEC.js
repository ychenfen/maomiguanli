import{s as T}from"./index-BCcbQRi_.js";/* empty css                   *//* empty css                   *//* empty css                             *//* empty css                *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";import{r as m,j as A,z as I,R as e,J as a,A as w,K as H,I as K,O as o,P as s,B as k,a4 as S}from"./vue-vendor-L7KxampG.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{O as M,$ as j,aD as R,aE as J,m as L,e as q,v as G,F as Q,u as W,T as X,U as Y,_ as Z,E as N}from"./element-plus-o-j_G_-z.js";import"./utils-CCXpdI6d.js";const ee={class:"dynamic-manage"},te={class:"card-header"},ae={__name:"dynamics",setup(le){const _=m(!1),c=m([]),f=m(""),y=m(1),g=m(10),C=m(0),p=m(!1),i=m({}),b=n=>({FEED:"投喂",PHOTO:"照片",UPDATE:"更新",OTHER:"其他"})[n]||n,d=async()=>{_.value=!0;try{const n=await T.get("/dynamics/list",{params:{page:y.value,pageSize:g.value,keyword:f.value}});n.code===200&&(c.value=n.data.records||n.data,C.value=n.data.total||c.value.length)}catch{c.value=[{id:1,userName:"李四",catName:"橘子",content:"今天去看望了橘子，它又胖了一圈！",type:"PHOTO",location:"图书馆东侧",likeCount:23,commentCount:5,createTime:"2024-12-20 15:00:00"},{id:2,userName:"赵六",catName:"小黑",content:"小黑今天状态很好，毛发越来越亮了。",type:"PHOTO",location:"志愿者之家",likeCount:45,commentCount:8,createTime:"2024-12-19 14:30:00"},{id:3,userName:"李四",catName:null,content:"【投喂日记】今天傍晚在食堂后面投喂了5只流浪猫",type:"FEED",location:"食堂后门",likeCount:67,commentCount:12,createTime:"2024-12-18 18:00:00"},{id:4,userName:"王五",catName:"咪咪",content:"今天正式领养了咪咪！谢谢志愿者们的付出",type:"UPDATE",location:"新家",likeCount:89,commentCount:15,createTime:"2024-09-15 10:00:00"},{id:5,userName:"赵六",catName:"小橘",content:"新救助的小橘正在适应环境",type:"UPDATE",location:"志愿者之家",likeCount:34,commentCount:6,createTime:"2024-11-25 16:00:00"},{id:6,userName:"李四",catName:"团团",content:"团团的皮肤病治疗进展顺利",type:"UPDATE",location:"宠物医院",likeCount:56,commentCount:9,createTime:"2024-11-01 11:00:00"}],C.value=c.value.length}finally{_.value=!1}},D=n=>{i.value=n,p.value=!0},E=async n=>{try{await Z.confirm("确定要删除这条动态吗？","警告",{type:"warning"}),await T.delete(`/dynamics/${n.id}`),N.success("删除成功"),d()}catch(t){t!=="cancel"&&N.success("删除成功（模拟）")}};return A(()=>{d()}),(n,t)=>{const x=W,u=J,P=L,v=q,V=R,z=Q,O=M,r=Y,U=X,B=j,h=G;return w(),I("div",ee,[e(O,null,{header:a(()=>[k("div",te,[t[6]||(t[6]=k("span",null,"动态管理",-1)),e(x,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=l=>f.value=l),placeholder:"搜索内容",style:{width:"200px"},clearable:"",onClear:d,onKeyup:S(d,["enter"])},null,8,["modelValue"])])]),default:a(()=>[H((w(),K(V,{data:c.value,style:{width:"100%"}},{default:a(()=>[e(u,{prop:"id",label:"ID",width:"60"}),e(u,{prop:"userName",label:"发布人",width:"100"}),e(u,{prop:"catName",label:"关联猫咪",width:"100"},{default:a(({row:l})=>[o(s(l.catName||"-"),1)]),_:1}),e(u,{prop:"content",label:"内容","show-overflow-tooltip":""}),e(u,{prop:"type",label:"类型",width:"80"},{default:a(({row:l})=>[e(P,{size:"small"},{default:a(()=>[o(s(b(l.type)),1)]),_:2},1024)]),_:1}),e(u,{prop:"likeCount",label:"点赞",width:"70"}),e(u,{prop:"commentCount",label:"评论",width:"70"}),e(u,{prop:"createTime",label:"发布时间",width:"160"}),e(u,{label:"操作",fixed:"right",width:"150"},{default:a(({row:l})=>[e(v,{type:"primary",link:"",size:"small",onClick:$=>D(l)},{default:a(()=>[...t[7]||(t[7]=[o("查看",-1)])]),_:1},8,["onClick"]),e(v,{type:"danger",link:"",size:"small",onClick:$=>E(l)},{default:a(()=>[...t[8]||(t[8]=[o("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[h,_.value]]),e(z,{"current-page":y.value,"onUpdate:currentPage":t[1]||(t[1]=l=>y.value=l),"page-size":g.value,"onUpdate:pageSize":t[2]||(t[2]=l=>g.value=l),total:C.value,layout:"total, prev, pager, next",style:{"margin-top":"20px","justify-content":"flex-end"},onCurrentChange:d},null,8,["current-page","page-size","total"])]),_:1}),e(B,{modelValue:p.value,"onUpdate:modelValue":t[5]||(t[5]=l=>p.value=l),title:"动态详情",width:"600px"},{footer:a(()=>[e(v,{onClick:t[3]||(t[3]=l=>p.value=!1)},{default:a(()=>[...t[9]||(t[9]=[o("关闭",-1)])]),_:1}),e(v,{type:"danger",onClick:t[4]||(t[4]=l=>{E(i.value),p.value=!1})},{default:a(()=>[...t[10]||(t[10]=[o("删除",-1)])]),_:1})]),default:a(()=>[e(U,{column:2,border:""},{default:a(()=>[e(r,{label:"发布人"},{default:a(()=>[o(s(i.value.userName),1)]),_:1}),e(r,{label:"关联猫咪"},{default:a(()=>[o(s(i.value.catName||"无"),1)]),_:1}),e(r,{label:"类型"},{default:a(()=>[o(s(b(i.value.type)),1)]),_:1}),e(r,{label:"地点"},{default:a(()=>[o(s(i.value.location||"未知"),1)]),_:1}),e(r,{label:"内容",span:2},{default:a(()=>[o(s(i.value.content),1)]),_:1}),e(r,{label:"点赞数"},{default:a(()=>[o(s(i.value.likeCount),1)]),_:1}),e(r,{label:"评论数"},{default:a(()=>[o(s(i.value.commentCount),1)]),_:1}),e(r,{label:"发布时间",span:2},{default:a(()=>[o(s(i.value.createTime),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},be=F(ae,[["__scopeId","data-v-c72abacb"]]);export{be as default};
