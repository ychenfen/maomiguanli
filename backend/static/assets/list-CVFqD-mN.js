import{_ as q}from"./index-59OIMCbR.js";/* empty css                   *//* empty css               *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                *//* empty css                        *//* empty css                       *//* empty css                        */import{r as h,l as H,c as J,aA as Q,w as j,o as K,B as u,E as t,C as e,D as a,az as W,z as d,Q as r,u as c,M as X,y as C,O as g,K as Z,a5 as tt,G as x,R as p}from"./vue-vendor-UlW9XFxV.js";import{e as st,R as et,E as at,l as lt,aa as ot,X as nt,P as it,W as dt,m as rt,Y as ut,B as ct,_ as pt,ab as mt,a4 as _t,ah as gt,J as vt,N as D,Q as ft,y as ht,ai as yt,a as Et}from"./element-plus-5e6ZgU0u.js";import{g as bt}from"./rescue-BHuK3UKq.js";import"./utils-Yxd-MeZx.js";const Ct={class:"rescue-list-page"},Nt={class:"banner"},zt={class:"container"},wt={class:"banner-content"},kt={class:"container"},Lt={class:"filter-tabs"},St={class:"rescue-list"},xt={key:1,class:"rescue-cards"},Dt={class:"rescue-content"},Rt={key:0,class:"rescue-image"},It={key:0,class:"image-count"},Pt={class:"rescue-info"},Vt={class:"rescue-title"},Bt={class:"rescue-desc"},Ot={class:"rescue-meta"},Gt={class:"meta-item"},Mt={class:"meta-item"},At={class:"meta-item"},Tt={key:0,class:"rescue-contact"},Yt={key:2,class:"pagination-wrapper"},$t={class:"card-header"},Ft={class:"card-header"},Ut={__name:"list",setup(qt){const N=Q(),z=W(),v=h(!1),f=h(""),n=H({page:1,size:10}),y=h([]),E=h(0),w=J(()=>{const l=N.query.author,s=l?Number(l):NaN;return Number.isFinite(s)?s:null}),R=l=>{if(!l)return[];if(Array.isArray(l))return l;try{const s=JSON.parse(l);return Array.isArray(s)?s:[]}catch{return[]}},m=async()=>{v.value=!0;try{const l={pageNum:n.page,pageSize:n.size};f.value&&(l.status=f.value),w.value&&(l.userId=w.value);const s=await bt(l);s.code===200&&(y.value=(s.data.records||[]).map(i=>({...i,imagesList:R(i.images)})),E.value=s.data.total||0)}catch{at.error("加载救助列表失败")}finally{v.value=!1}},I=()=>{n.page=1,m()};j(()=>N.query.author,()=>{n.page=1,m()});const P=l=>{n.page=l,m(),window.scrollTo({top:0,behavior:"smooth"})},V=l=>{n.size=l,n.page=1,m()},k=()=>{z.push("/rescue/publish")},B=l=>{z.push(`/rescue/${l}`)},O=l=>({PENDING:"待救助",PROCESSING:"处理中",RESOLVED:"已解决",CLOSED:"已关闭"})[l]||l,G=l=>l?Et(l).format("YYYY-MM-DD HH:mm"):"-";return K(()=>{m()}),(l,s)=>{const i=lt,L=st,_=dt,M=it,A=rt,T=ct,Y=pt,b=ut,$=ft,S=nt,F=et,U=ht;return d(),u("div",Ct,[t("div",Nt,[t("div",zt,[t("div",wt,[s[4]||(s[4]=t("h1",null,"救助信息",-1)),s[5]||(s[5]=t("p",null,"发现需要帮助的流浪猫？发布救助信息，让更多人参与进来",-1)),e(L,{type:"primary",size:"large",onClick:k},{default:a(()=>[e(i,null,{default:a(()=>[e(c(ot))]),_:1}),s[3]||(s[3]=r(" 发布救助信息 ",-1))]),_:1})])])]),t("div",kt,[e(F,{gutter:24},{default:a(()=>[e(S,{xs:24,lg:16},{default:a(()=>[t("div",Lt,[e(M,{modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=o=>f.value=o),onChange:I},{default:a(()=>[e(_,{label:""},{default:a(()=>[...s[6]||(s[6]=[r("全部",-1)])]),_:1}),e(_,{label:"PENDING"},{default:a(()=>[...s[7]||(s[7]=[r("待救助",-1)])]),_:1}),e(_,{label:"PROCESSING"},{default:a(()=>[...s[8]||(s[8]=[r("处理中",-1)])]),_:1}),e(_,{label:"RESOLVED"},{default:a(()=>[...s[9]||(s[9]=[r("已解决",-1)])]),_:1}),e(_,{label:"CLOSED"},{default:a(()=>[...s[10]||(s[10]=[r("已关闭",-1)])]),_:1})]),_:1},8,["modelValue"])]),X((d(),u("div",St,[!v.value&&y.value.length===0?(d(),C(A,{key:0,description:"暂无救助信息"},{default:a(()=>[e(L,{type:"primary",onClick:k},{default:a(()=>[...s[11]||(s[11]=[r(" 发布救助信息 ",-1)])]),_:1})]),_:1})):(d(),u("div",xt,[(d(!0),u(Z,null,tt(y.value,o=>(d(),C(b,{key:o.id,class:x(["rescue-card",`status-${o.status.toLowerCase()}`]),onClick:Ht=>B(o.id)},{default:a(()=>[t("div",{class:x(["status-badge",`badge-${o.status.toLowerCase()}`])},p(O(o.status)),3),o.priority===1?(d(),C(T,{key:0,type:"danger",size:"small",class:"urgency-tag"},{default:a(()=>[...s[12]||(s[12]=[r(" 紧急 ",-1)])]),_:1})):g("",!0),t("div",Dt,[o.imagesList&&o.imagesList.length>0?(d(),u("div",Rt,[e(Y,{src:o.imagesList[0],fit:"cover","preview-src-list":o.imagesList},null,8,["src","preview-src-list"]),o.imagesList.length>1?(d(),u("div",It,[e(i,null,{default:a(()=>[e(c(mt))]),_:1}),r(" "+p(o.imagesList.length),1)])):g("",!0)])):g("",!0),t("div",Pt,[t("h3",Vt,p(o.title),1),t("div",Bt,p(o.description),1),t("div",Ot,[t("div",Gt,[e(i,null,{default:a(()=>[e(c(_t))]),_:1}),t("span",null,p(o.location),1)]),t("div",Mt,[e(i,null,{default:a(()=>[e(c(gt))]),_:1}),t("span",null,p(G(o.createTime)),1)]),t("div",At,[e(i,null,{default:a(()=>[e(c(vt))]),_:1}),t("span",null,p(o.username),1)])]),o.status==="PENDING"?(d(),u("div",Tt,[e(i,null,{default:a(()=>[e(c(D))]),_:1}),t("span",null,p(o.contactPhone),1)])):g("",!0)])])]),_:2},1032,["class","onClick"]))),128))])),E.value>0?(d(),u("div",Yt,[e($,{"current-page":n.page,"onUpdate:currentPage":s[1]||(s[1]=o=>n.page=o),"page-size":n.size,"onUpdate:pageSize":s[2]||(s[2]=o=>n.size=o),total:E.value,"page-sizes":[10,20,30],layout:"total, sizes, prev, pager, next",onSizeChange:V,onCurrentChange:P},null,8,["current-page","page-size","total"])])):g("",!0)])),[[U,v.value]])]),_:1}),e(S,{xs:24,lg:8},{default:a(()=>[e(b,{class:"side-card guide-card"},{header:a(()=>[t("div",$t,[e(i,null,{default:a(()=>[e(c(yt))]),_:1}),s[13]||(s[13]=t("span",null,"救助指南",-1))])]),default:a(()=>[s[14]||(s[14]=t("div",{class:"guide-content"},[t("div",{class:"guide-item"},[t("div",{class:"guide-number"},"1"),t("div",{class:"guide-text"},[t("h4",null,"评估情况"),t("p",null,"观察猫咪是否受伤、生病或处于危险中")])]),t("div",{class:"guide-item"},[t("div",{class:"guide-number"},"2"),t("div",{class:"guide-text"},[t("h4",null,"确保安全"),t("p",null,"在安全的前提下接近猫咪，避免惊吓")])]),t("div",{class:"guide-item"},[t("div",{class:"guide-number"},"3"),t("div",{class:"guide-text"},[t("h4",null,"发布信息"),t("p",null,"详细描述地点、情况，上传清晰照片")])]),t("div",{class:"guide-item"},[t("div",{class:"guide-number"},"4"),t("div",{class:"guide-text"},[t("h4",null,"联系志愿者"),t("p",null,"等待志愿者响应，提供必要协助")])]),t("div",{class:"guide-item"},[t("div",{class:"guide-number"},"5"),t("div",{class:"guide-text"},[t("h4",null,"后续跟进"),t("p",null,"及时更新救助进展，帮助猫咪恢复")])])],-1))]),_:1}),e(b,{class:"side-card contact-card"},{header:a(()=>[t("div",Ft,[e(i,null,{default:a(()=>[e(c(D))]),_:1}),s[15]||(s[15]=t("span",null,"紧急联系",-1))])]),default:a(()=>[s[16]||(s[16]=t("div",{class:"contact-list"},[t("div",{class:"contact-item"},[t("div",{class:"contact-name"},"校园流浪动物救助站"),t("div",{class:"contact-phone"},"123-4567-8890")]),t("div",{class:"contact-item"},[t("div",{class:"contact-name"},"24小时急救热线"),t("div",{class:"contact-phone"},"400-123-4567")]),t("div",{class:"contact-item"},[t("div",{class:"contact-name"},"志愿者微信群"),t("div",{class:"contact-wechat"},"扫码加入 →")])],-1))]),_:1})]),_:1})]),_:1})])])}}},ds=q(Ut,[["__scopeId","data-v-20eb4586"]]);export{ds as default};
