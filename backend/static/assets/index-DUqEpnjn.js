import{_ as q,r as Q,h as J,i as X,j as Z,m as ee,k as z,l as ae}from"./index-59OIMCbR.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                     *//* empty css                */import{r as _,o as te,B as v,C as e,D as l,z as r,E as n,u as M,Q as d,R as u,M as oe,y as m,O as y,K as le,a5 as se,G as ne,P as ie,Y as A}from"./vue-vendor-UlW9XFxV.js";import{a as w,Y as re,E as p,e as ce,n as de,B as ue,F as pe,H as _e,S as fe,T as ve,m as me,l as ye,J as ge,ah as Ee,y as Ne,Q as Ce,a5 as I,p as he,s as Te,q as be,w as ke,t as Oe,f as L}from"./element-plus-5e6ZgU0u.js";import"./utils-Yxd-MeZx.js";const Re={class:"notification-container"},Me={class:"header-content"},we={class:"header-actions"},xe={class:"stats-row"},Se={class:"notification-list"},ze=["onClick"],Ae={class:"notification-icon"},Ie={class:"notification-body"},Le={class:"notification-title"},Ve={class:"title-text"},Be={class:"notification-content-text"},Ue={class:"notification-meta"},De={key:0,class:"sender"},Pe={class:"time"},Fe={class:"notification-actions"},Ge={__name:"index",setup(He){w.extend(Q),w.locale("zh-cn");const E=_(!1),N=_([]),C=_(0),g=_(0),h=_({}),i=_({pageNum:1,pageSize:10,type:"",isRead:null,priority:""}),c=async()=>{E.value=!0;try{const a=await J(i.value);a.code===200&&(N.value=a.data.records,C.value=a.data.total)}catch{p.error("加载通知失败")}finally{E.value=!1}},f=async()=>{try{const[a,t]=await Promise.all([X(),Z()]);a.code===200&&(g.value=a.data),t.code===200&&(h.value=t.data)}catch(a){console.error("加载统计信息失败",a)}},V=async a=>{try{(await z(a)).code===200&&(p.success("已标记为已读"),c(),f())}catch{p.error("操作失败")}},B=async()=>{if(g.value!==0)try{await I.confirm(`确定要将所有 ${g.value} 条未读通知标记为已读吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),(await ee()).code===200&&(p.success("全部标记为已读"),c(),f())}catch(a){a!=="cancel"&&p.error("操作失败")}},U=async a=>{try{await I.confirm("确定要删除这条通知吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),(await ae(a)).code===200&&(p.success("删除成功"),c(),f())}catch(t){t!=="cancel"&&p.error("删除失败")}},D=async a=>{a.isRead===0&&(await z(a.id),f()),console.log("跳转到相关页面",a)},P=a=>({SYSTEM:L,ADOPTION:Oe,RESCUE:ke,COMMENT:be,LIKE:Te,DONATION:he})[a]||L,F=a=>({SYSTEM:"#909399",ADOPTION:"#409EFF",RESCUE:"#E6A23C",COMMENT:"#67C23A",LIKE:"#F56C6C",DONATION:"#409EFF"})[a]||"#909399",G=a=>({LOW:"info",NORMAL:"",HIGH:"warning",URGENT:"danger"})[a]||"",H=a=>({LOW:"低",NORMAL:"普通",HIGH:"高",URGENT:"紧急"})[a]||"",Y=a=>w(a).fromNow();return te(()=>{c(),f()}),(a,t)=>{const T=ce,b=ue,x=re,s=ve,k=fe,O=_e,K=pe,$=me,R=ye,j=Ce,W=Ne;return r(),v("div",Re,[e(x,{class:"notification-header"},{default:l(()=>[n("div",Me,[t[6]||(t[6]=n("h2",null,"消息中心",-1)),n("div",we,[e(T,{type:"primary",icon:M(de),onClick:B,disabled:g.value===0},{default:l(()=>[...t[5]||(t[5]=[d(" 全部标记为已读 ",-1)])]),_:1},8,["icon","disabled"])])]),n("div",xe,[e(b,{type:"info"},{default:l(()=>[d("全部通知: "+u(h.value.total||0),1)]),_:1}),e(b,{type:"warning"},{default:l(()=>[d("未读: "+u(h.value.unread||0),1)]),_:1})])]),_:1}),e(x,{class:"notification-content"},{default:l(()=>[e(K,{inline:!0,class:"filter-form"},{default:l(()=>[e(O,{label:"通知类型"},{default:l(()=>[e(k,{modelValue:i.value.type,"onUpdate:modelValue":t[0]||(t[0]=o=>i.value.type=o),placeholder:"全部类型",clearable:"",onChange:c},{default:l(()=>[e(s,{label:"全部",value:""}),e(s,{label:"系统通知",value:"SYSTEM"}),e(s,{label:"领养通知",value:"ADOPTION"}),e(s,{label:"救助通知",value:"RESCUE"}),e(s,{label:"评论通知",value:"COMMENT"}),e(s,{label:"点赞通知",value:"LIKE"}),e(s,{label:"捐赠通知",value:"DONATION"})]),_:1},8,["modelValue"])]),_:1}),e(O,{label:"已读状态"},{default:l(()=>[e(k,{modelValue:i.value.isRead,"onUpdate:modelValue":t[1]||(t[1]=o=>i.value.isRead=o),placeholder:"全部状态",clearable:"",onChange:c},{default:l(()=>[e(s,{label:"全部",value:null}),e(s,{label:"未读",value:0}),e(s,{label:"已读",value:1})]),_:1},8,["modelValue"])]),_:1}),e(O,{label:"优先级"},{default:l(()=>[e(k,{modelValue:i.value.priority,"onUpdate:modelValue":t[2]||(t[2]=o=>i.value.priority=o),placeholder:"全部优先级",clearable:"",onChange:c},{default:l(()=>[e(s,{label:"全部",value:""}),e(s,{label:"低",value:"LOW"}),e(s,{label:"普通",value:"NORMAL"}),e(s,{label:"高",value:"HIGH"}),e(s,{label:"紧急",value:"URGENT"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),oe((r(),v("div",Se,[N.value.length===0?(r(),m($,{key:0,description:"暂无通知"})):y("",!0),(r(!0),v(le,null,se(N.value,o=>(r(),v("div",{key:o.id,class:ne(["notification-item",{"is-unread":o.isRead===0}]),onClick:S=>D(o)},[n("div",Ae,[e(R,{size:24,color:F(o.type)},{default:l(()=>[(r(),m(ie(P(o.type))))]),_:2},1032,["color"])]),n("div",Ie,[n("div",Le,[n("span",Ve,u(o.title),1),o.priority!=="NORMAL"?(r(),m(b,{key:0,type:G(o.priority),size:"small"},{default:l(()=>[d(u(H(o.priority)),1)]),_:2},1032,["type"])):y("",!0)]),n("div",Be,u(o.content),1),n("div",Ue,[o.senderName?(r(),v("span",De,[e(R,null,{default:l(()=>[e(M(ge))]),_:1}),d(" "+u(o.senderName),1)])):y("",!0),n("span",Pe,[e(R,null,{default:l(()=>[e(M(Ee))]),_:1}),d(" "+u(Y(o.createTime)),1)])])]),n("div",Fe,[o.isRead===0?(r(),m(T,{key:0,size:"small",onClick:A(S=>V(o.id),["stop"])},{default:l(()=>[...t[7]||(t[7]=[d(" 标记已读 ",-1)])]),_:1},8,["onClick"])):y("",!0),e(T,{size:"small",type:"danger",plain:"",onClick:A(S=>U(o.id),["stop"])},{default:l(()=>[...t[8]||(t[8]=[d(" 删除 ",-1)])]),_:1},8,["onClick"])])],10,ze))),128))])),[[W,E.value]]),C.value>0?(r(),m(j,{key:0,class:"pagination","current-page":i.value.pageNum,"onUpdate:currentPage":t[3]||(t[3]=o=>i.value.pageNum=o),"page-size":i.value.pageSize,"onUpdate:pageSize":t[4]||(t[4]=o=>i.value.pageSize=o),"page-sizes":[10,20,50,100],total:C.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:c,onCurrentChange:c},null,8,["current-page","page-size","total"])):y("",!0)]),_:1})])}}},aa=q(Ge,[["__scopeId","data-v-01e7d1d7"]]);export{aa as default};
