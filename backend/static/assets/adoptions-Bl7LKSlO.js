import{s as P}from"./index-DH5c_PcU.js";/* empty css                   *//* empty css                     *//* empty css                 *//* empty css                   *//* empty css                             *//* empty css                *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{O as H,$ as K,aD as Q,aE as W,m as X,e as Y,v as Z,F as ee,I as te,J as ae,T as le,U as oe,q as ne,r as se,u as ie,_ as ue,E as f}from"./element-plus-o-j_G_-z.js";import{r as i,w as re,j as pe,z as I,R as e,J as a,A as V,K as de,I as ce,O as n,P as u,L as me,Q as ve,B as R}from"./vue-vendor-L7KxampG.js";import"./utils-CCXpdI6d.js";const _e={class:"adoption-manage"},fe={class:"card-header"},ge={__name:"adoptions",setup(Ee){const b=i(!1),m=i([]),g=i(""),E=i(1),C=i(10),D=i(0),N=i(!1),v=i(!1),s=i({}),d=i({id:null,reason:""}),x=l=>({PENDING:"warning",APPROVED:"success",REJECTED:"danger",CANCELLED:"info"})[l]||"info",w=l=>({PENDING:"待审核",APPROVED:"已通过",REJECTED:"已拒绝",CANCELLED:"已取消"})[l]||l,_=async()=>{b.value=!0;try{const l=await P.get("/adoption-applications/page",{params:{page:E.value,pageSize:C.value,status:g.value}});l.code===200&&(m.value=l.data.records||l.data,D.value=l.data.total||m.value.length)}catch{m.value=[{id:1,catName:"橘子",userName:"王五",contactPhone:"13800138003",contactAddress:"海淀区学院路小区",reason:"我非常喜欢橘猫，承诺会好好照顾它。",livingCondition:"独立住房，有阳台，已安装纱窗",experience:"之前养过一只猫5年",status:"PENDING",createTime:"2024-12-24 12:00:00"},{id:2,catName:"小黑",userName:"孙七",contactPhone:"13800138005",contactAddress:"朝阳区望京SOHO",reason:"看到小黑的照片就被吸引了。",livingCondition:"合租公寓，室友同意养猫",experience:"家里养过猫",status:"PENDING",createTime:"2024-12-24 14:00:00"},{id:3,catName:"咪咪",userName:"王五",contactPhone:"13800138003",contactAddress:"海淀区五道口",reason:"咪咪太可爱了，希望能领养它。",livingCondition:"独立住房",experience:"有3年养猫经验",status:"APPROVED",createTime:"2024-09-01 10:00:00"},{id:4,catName:"奶牛",userName:"孙七",contactPhone:"13800138005",contactAddress:"朝阳区三里屯",reason:"奶牛的花色太好看了。",livingCondition:"独立公寓",experience:"有养猫经验",status:"REJECTED",createTime:"2024-10-20 09:00:00"}],D.value=m.value.length}finally{b.value=!1}},O=l=>{s.value=l,N.value=!0},$=async l=>{try{await ue.confirm(`确定通过 "${l.userName}" 对猫咪 "${l.catName}" 的领养申请吗？`,"确认",{type:"success"}),await P.put(`/adoption-applications/${l.id}/approve`),f.success("审核通过"),_()}catch(t){t!=="cancel"&&(l.status="APPROVED",f.success("审核通过（模拟）"))}},z=l=>{d.value={id:l.id,reason:""},v.value=!0},S=async()=>{if(!d.value.reason){f.warning("请输入拒绝原因");return}try{await P.put(`/adoption-applications/${d.value.id}/reject`,{reason:d.value.reason}),f.success("已拒绝")}catch{f.success("已拒绝（模拟）")}v.value=!1,_()};return re(g,()=>{E.value=1,_()}),pe(()=>{_()}),(l,t)=>{const y=ae,j=te,p=W,T=X,c=Y,B=Q,U=ee,h=H,r=oe,F=le,k=K,G=ie,J=se,L=ne,M=Z;return V(),I("div",_e,[e(h,null,{header:a(()=>[R("div",fe,[t[8]||(t[8]=R("span",null,"领养审核",-1)),e(j,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=o=>g.value=o),placeholder:"状态筛选",clearable:"",style:{width:"120px"}},{default:a(()=>[e(y,{label:"待审核",value:"PENDING"}),e(y,{label:"已通过",value:"APPROVED"}),e(y,{label:"已拒绝",value:"REJECTED"})]),_:1},8,["modelValue"])])]),default:a(()=>[de((V(),ce(B,{data:m.value,style:{width:"100%"}},{default:a(()=>[e(p,{prop:"id",label:"ID",width:"60"}),e(p,{prop:"catName",label:"猫咪",width:"100"}),e(p,{prop:"userName",label:"申请人",width:"100"}),e(p,{prop:"contactPhone",label:"联系电话",width:"130"}),e(p,{prop:"reason",label:"领养理由","show-overflow-tooltip":""}),e(p,{prop:"status",label:"状态",width:"100"},{default:a(({row:o})=>[e(T,{type:x(o.status)},{default:a(()=>[n(u(w(o.status)),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"createTime",label:"申请时间",width:"160"}),e(p,{label:"操作",fixed:"right",width:"200"},{default:a(({row:o})=>[o.status==="PENDING"?(V(),I(ve,{key:0},[e(c,{type:"success",link:"",size:"small",onClick:A=>$(o)},{default:a(()=>[...t[9]||(t[9]=[n("通过",-1)])]),_:1},8,["onClick"]),e(c,{type:"danger",link:"",size:"small",onClick:A=>z(o)},{default:a(()=>[...t[10]||(t[10]=[n("拒绝",-1)])]),_:1},8,["onClick"])],64)):me("",!0),e(c,{type:"primary",link:"",size:"small",onClick:A=>O(o)},{default:a(()=>[...t[11]||(t[11]=[n("详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[M,b.value]]),e(U,{"current-page":E.value,"onUpdate:currentPage":t[1]||(t[1]=o=>E.value=o),"page-size":C.value,"onUpdate:pageSize":t[2]||(t[2]=o=>C.value=o),total:D.value,layout:"total, prev, pager, next",style:{"margin-top":"20px","justify-content":"flex-end"},onCurrentChange:_},null,8,["current-page","page-size","total"])]),_:1}),e(k,{modelValue:N.value,"onUpdate:modelValue":t[4]||(t[4]=o=>N.value=o),title:"申请详情",width:"600px"},{footer:a(()=>[e(c,{onClick:t[3]||(t[3]=o=>N.value=!1)},{default:a(()=>[...t[12]||(t[12]=[n("关闭",-1)])]),_:1})]),default:a(()=>[e(F,{column:2,border:""},{default:a(()=>[e(r,{label:"猫咪名称"},{default:a(()=>[n(u(s.value.catName),1)]),_:1}),e(r,{label:"申请人"},{default:a(()=>[n(u(s.value.userName),1)]),_:1}),e(r,{label:"联系电话"},{default:a(()=>[n(u(s.value.contactPhone),1)]),_:1}),e(r,{label:"联系地址"},{default:a(()=>[n(u(s.value.contactAddress),1)]),_:1}),e(r,{label:"领养理由",span:2},{default:a(()=>[n(u(s.value.reason),1)]),_:1}),e(r,{label:"居住条件",span:2},{default:a(()=>[n(u(s.value.livingCondition),1)]),_:1}),e(r,{label:"养猫经验",span:2},{default:a(()=>[n(u(s.value.experience),1)]),_:1}),e(r,{label:"申请时间"},{default:a(()=>[n(u(s.value.createTime),1)]),_:1}),e(r,{label:"状态"},{default:a(()=>[e(T,{type:x(s.value.status)},{default:a(()=>[n(u(w(s.value.status)),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(k,{modelValue:v.value,"onUpdate:modelValue":t[7]||(t[7]=o=>v.value=o),title:"拒绝申请",width:"400px"},{footer:a(()=>[e(c,{onClick:t[6]||(t[6]=o=>v.value=!1)},{default:a(()=>[...t[13]||(t[13]=[n("取消",-1)])]),_:1}),e(c,{type:"danger",onClick:S},{default:a(()=>[...t[14]||(t[14]=[n("确认拒绝",-1)])]),_:1})]),default:a(()=>[e(L,{model:d.value,"label-width":"80px"},{default:a(()=>[e(J,{label:"拒绝原因",required:""},{default:a(()=>[e(G,{modelValue:d.value.reason,"onUpdate:modelValue":t[5]||(t[5]=o=>d.value.reason=o),type:"textarea",rows:4,placeholder:"请输入拒绝原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Se=q(ge,[["__scopeId","data-v-d787efa3"]]);export{Se as default};
