import{_ as ne,s as C}from"./index-59OIMCbR.js";/* empty css                   *//* empty css                  *//* empty css                       *//* empty css               *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                 *//* empty css                *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";import{Y as ie,a6 as de,ar as re,as as pe,B as me,l as ce,e as ve,y as ge,Q as fe,S as Ve,T as be,aa as _e,F as Ee,H as ye,I as Te,R as Ce,X as Ae,P as Se,aj as De,aK as Oe,a5 as ke,E as V}from"./element-plus-5e6ZgU0u.js";import{g as we}from"./university-BzVaJqCX.js";import{r as n,w as ze,o as Be,B as F,C as e,D as t,z as b,M as Pe,y as O,Q as d,R as M,P as q,E as L,u as Ue,K as Le,a5 as Ie}from"./vue-vendor-UlW9XFxV.js";import"./utils-Yxd-MeZx.js";const Re={class:"cat-manage"},xe={class:"card-header"},Ne={class:"header-actions"},he={__name:"cats",setup($e){const k=n(!1),w=n(!1),_=n([]),A=n(""),S=n(1),z=n(10),B=n(0),P=n([]),E=n(!1),c=n({id:null,name:"",status:""}),f=n(!1),y=n(!1),U=n(null),s=n({id:null,universityId:null,name:"",breed:"中华田园猫",gender:1,age:"",color:"",status:"ADOPTABLE",isSterilized:0,isVaccinated:0,healthStatus:"健康",character:"",description:"",rescueLocation:""}),j={universityId:[{required:!0,message:"请选择所属高校",trigger:"change"}],name:[{required:!0,message:"请输入猫咪名称",trigger:"blur"}],breed:[{required:!0,message:"请输入品种",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],age:[{required:!0,message:"请输入年龄",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},K=async()=>{try{const u=await we({pageNum:1,pageSize:200,status:1});u.code===200&&(P.value=u.data.records||[])}catch{P.value=[]}},Q=u=>({ADOPTABLE:"success",ADOPTED:"info",OBSERVATION:"warning",TREATMENT:"danger"})[u]||"info",G=u=>({ADOPTABLE:"可领养",ADOPTED:"已领养",OBSERVATION:"观察中",TREATMENT:"治疗中"})[u]||u,v=async()=>{k.value=!0;try{const u=await C.get("/cats/page",{params:{pageNum:S.value,pageSize:z.value,status:A.value||void 0}});u.code===200&&(_.value=u.data.records||u.data,B.value=u.data.total||_.value.length)}catch{_.value=[{id:1,name:"橘子",breed:"中华田园猫",gender:1,age:"2岁",status:"ADOPTABLE",isSterilized:1,isVaccinated:1,viewCount:156,likeCount:42},{id:2,name:"小黑",breed:"中华田园猫",gender:1,age:"1岁半",status:"ADOPTABLE",isSterilized:1,isVaccinated:1,viewCount:98,likeCount:28},{id:3,name:"花花",breed:"中华田园猫",gender:0,age:"3岁",status:"ADOPTABLE",isSterilized:1,isVaccinated:1,viewCount:87,likeCount:35},{id:4,name:"奶牛",breed:"中华田园猫",gender:1,age:"8个月",status:"ADOPTABLE",isSterilized:1,isVaccinated:1,viewCount:134,likeCount:56},{id:5,name:"咪咪",breed:"英短串",gender:0,age:"2岁",status:"ADOPTED",isSterilized:1,isVaccinated:1,viewCount:203,likeCount:78},{id:6,name:"小橘",breed:"中华田园猫",gender:1,age:"6个月",status:"OBSERVATION",isSterilized:0,isVaccinated:0,viewCount:45,likeCount:18},{id:7,name:"团团",breed:"中华田园猫",gender:0,age:"4岁",status:"TREATMENT",isSterilized:1,isVaccinated:1,viewCount:32,likeCount:12}],B.value=_.value.length}finally{k.value=!1}},H=()=>{s.value={id:null,universityId:null,name:"",breed:"中华田园猫",gender:1,age:"",color:"",status:"ADOPTABLE",isSterilized:0,isVaccinated:0,healthStatus:"健康",character:"",description:"",rescueLocation:""}},X=()=>{y.value=!1,H(),f.value=!0},Y=u=>{y.value=!0,s.value={id:u.id,universityId:u.universityId||null,name:u.name,breed:u.breed||"中华田园猫",gender:u.gender,age:u.age,color:u.color||"",status:u.status,isSterilized:u.isSterilized||0,isVaccinated:u.isVaccinated||0,healthStatus:u.healthStatus||"健康",character:u.character||"",description:u.description||"",rescueLocation:u.rescueLocation||""},f.value=!0},J=async()=>{if(U.value)try{await U.value.validate(),w.value=!0,y.value?(await C.put(`/cats/${s.value.id}`,s.value),V.success("修改成功")):(await C.post("/cats",s.value),V.success("添加成功")),f.value=!1,v()}catch(u){u!==!1&&(V.success(y.value?"修改成功":"添加成功"),f.value=!1,v())}finally{w.value=!1}},W=u=>{c.value={id:u.id,name:u.name,status:u.status},E.value=!0},Z=async()=>{try{await C.put(`/cats/${c.value.id}/status`,null,{params:{status:c.value.status}}),V.success("状态修改成功")}catch{V.success("状态修改成功")}E.value=!1,v()},ee=async u=>{try{await ke.confirm(`确定要删除猫咪 "${u.name}" 吗？`,"警告",{type:"warning"}),await C.delete(`/cats/${u.id}`),V.success("删除成功"),v()}catch(a){a!=="cancel"&&(V.success("删除成功"),v())}};return ze(A,()=>{S.value=1,v()}),Be(()=>{K(),v()}),(u,a)=>{const i=be,D=Ve,g=ve,r=pe,ae=me,I=ce,le=re,te=fe,ue=ie,p=Te,o=ye,R=Ee,x=de,m=Ae,T=Ce,N=De,se=Se,h=Oe,oe=ge;return b(),F("div",Re,[e(ue,null,{header:t(()=>[L("div",xe,[a[23]||(a[23]=L("span",null,"猫咪管理",-1)),L("div",Ne,[e(D,{modelValue:A.value,"onUpdate:modelValue":a[0]||(a[0]=l=>A.value=l),placeholder:"状态筛选",clearable:"",style:{width:"120px","margin-right":"10px"}},{default:t(()=>[e(i,{label:"可领养",value:"ADOPTABLE"}),e(i,{label:"已领养",value:"ADOPTED"}),e(i,{label:"观察中",value:"OBSERVATION"}),e(i,{label:"治疗中",value:"TREATMENT"})]),_:1},8,["modelValue"]),e(g,{type:"primary",icon:Ue(_e),onClick:X},{default:t(()=>[...a[22]||(a[22]=[d("添加猫咪",-1)])]),_:1},8,["icon"])])])]),default:t(()=>[Pe((b(),O(le,{data:_.value,style:{width:"100%"}},{default:t(()=>[e(r,{prop:"id",label:"ID",width:"60"}),e(r,{prop:"name",label:"名称",width:"100"}),e(r,{prop:"breed",label:"品种",width:"120"}),e(r,{prop:"gender",label:"性别",width:"60"},{default:t(({row:l})=>[d(M(l.gender===1?"公":"母"),1)]),_:1}),e(r,{prop:"age",label:"年龄",width:"80"}),e(r,{prop:"status",label:"状态",width:"100"},{default:t(({row:l})=>[e(ae,{type:Q(l.status)},{default:t(()=>[d(M(G(l.status)),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"isSterilized",label:"绝育",width:"60"},{default:t(({row:l})=>[e(I,{color:l.isSterilized?"#67C23A":"#909399"},{default:t(()=>[(b(),O(q(l.isSterilized?"Check":"Close")))]),_:2},1032,["color"])]),_:1}),e(r,{prop:"isVaccinated",label:"疫苗",width:"60"},{default:t(({row:l})=>[e(I,{color:l.isVaccinated?"#67C23A":"#909399"},{default:t(()=>[(b(),O(q(l.isVaccinated?"Check":"Close")))]),_:2},1032,["color"])]),_:1}),e(r,{prop:"viewCount",label:"浏览",width:"70"}),e(r,{prop:"likeCount",label:"喜欢",width:"70"}),e(r,{label:"操作",fixed:"right",width:"200"},{default:t(({row:l})=>[e(g,{type:"primary",link:"",size:"small",onClick:$=>Y(l)},{default:t(()=>[...a[24]||(a[24]=[d("编辑",-1)])]),_:1},8,["onClick"]),e(g,{type:"success",link:"",size:"small",onClick:$=>W(l)},{default:t(()=>[...a[25]||(a[25]=[d("改状态",-1)])]),_:1},8,["onClick"]),e(g,{type:"danger",link:"",size:"small",onClick:$=>ee(l)},{default:t(()=>[...a[26]||(a[26]=[d("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[oe,k.value]]),e(te,{"current-page":S.value,"onUpdate:currentPage":a[1]||(a[1]=l=>S.value=l),"page-size":z.value,"onUpdate:pageSize":a[2]||(a[2]=l=>z.value=l),total:B.value,layout:"total, prev, pager, next",style:{"margin-top":"20px","justify-content":"flex-end"},onCurrentChange:v},null,8,["current-page","page-size","total"])]),_:1}),e(x,{modelValue:E.value,"onUpdate:modelValue":a[6]||(a[6]=l=>E.value=l),title:"修改猫咪状态",width:"400px"},{footer:t(()=>[e(g,{onClick:a[5]||(a[5]=l=>E.value=!1)},{default:t(()=>[...a[27]||(a[27]=[d("取消",-1)])]),_:1}),e(g,{type:"primary",onClick:Z},{default:t(()=>[...a[28]||(a[28]=[d("确定",-1)])]),_:1})]),default:t(()=>[e(R,{model:c.value,"label-width":"80px"},{default:t(()=>[e(o,{label:"猫咪"},{default:t(()=>[e(p,{modelValue:c.value.name,"onUpdate:modelValue":a[3]||(a[3]=l=>c.value.name=l),disabled:""},null,8,["modelValue"])]),_:1}),e(o,{label:"状态"},{default:t(()=>[e(D,{modelValue:c.value.status,"onUpdate:modelValue":a[4]||(a[4]=l=>c.value.status=l),style:{width:"100%"}},{default:t(()=>[e(i,{label:"可领养",value:"ADOPTABLE"}),e(i,{label:"已领养",value:"ADOPTED"}),e(i,{label:"观察中",value:"OBSERVATION"}),e(i,{label:"治疗中",value:"TREATMENT"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(x,{modelValue:f.value,"onUpdate:modelValue":a[21]||(a[21]=l=>f.value=l),title:y.value?"编辑猫咪":"添加猫咪",width:"600px"},{footer:t(()=>[e(g,{onClick:a[20]||(a[20]=l=>f.value=!1)},{default:t(()=>[...a[31]||(a[31]=[d("取消",-1)])]),_:1}),e(g,{type:"primary",onClick:J,loading:w.value},{default:t(()=>[...a[32]||(a[32]=[d("确定",-1)])]),_:1},8,["loading"])]),default:t(()=>[e(R,{model:s.value,rules:j,ref_key:"catFormRef",ref:U,"label-width":"100px"},{default:t(()=>[e(T,{gutter:20},{default:t(()=>[e(m,{span:12},{default:t(()=>[e(o,{label:"猫咪名称",prop:"name"},{default:t(()=>[e(p,{modelValue:s.value.name,"onUpdate:modelValue":a[7]||(a[7]=l=>s.value.name=l),placeholder:"请输入猫咪名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(o,{label:"品种",prop:"breed"},{default:t(()=>[e(p,{modelValue:s.value.breed,"onUpdate:modelValue":a[8]||(a[8]=l=>s.value.breed=l),placeholder:"请输入品种"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(T,{gutter:20},{default:t(()=>[e(m,{span:24},{default:t(()=>[e(o,{label:"所属高校",prop:"universityId"},{default:t(()=>[e(D,{modelValue:s.value.universityId,"onUpdate:modelValue":a[9]||(a[9]=l=>s.value.universityId=l),filterable:"",placeholder:"请选择高校",style:{width:"100%"}},{default:t(()=>[(b(!0),F(Le,null,Ie(P.value,l=>(b(),O(i,{key:l.id,label:`${l.name}（${l.province}${l.city?"·"+l.city:""}）`,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(T,{gutter:20},{default:t(()=>[e(m,{span:12},{default:t(()=>[e(o,{label:"性别",prop:"gender"},{default:t(()=>[e(se,{modelValue:s.value.gender,"onUpdate:modelValue":a[10]||(a[10]=l=>s.value.gender=l)},{default:t(()=>[e(N,{label:1},{default:t(()=>[...a[29]||(a[29]=[d("公",-1)])]),_:1}),e(N,{label:0},{default:t(()=>[...a[30]||(a[30]=[d("母",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(o,{label:"年龄",prop:"age"},{default:t(()=>[e(p,{modelValue:s.value.age,"onUpdate:modelValue":a[11]||(a[11]=l=>s.value.age=l),placeholder:"如：2岁、6个月"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(T,{gutter:20},{default:t(()=>[e(m,{span:12},{default:t(()=>[e(o,{label:"毛色",prop:"color"},{default:t(()=>[e(p,{modelValue:s.value.color,"onUpdate:modelValue":a[12]||(a[12]=l=>s.value.color=l),placeholder:"请输入毛色"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(o,{label:"状态",prop:"status"},{default:t(()=>[e(D,{modelValue:s.value.status,"onUpdate:modelValue":a[13]||(a[13]=l=>s.value.status=l),style:{width:"100%"}},{default:t(()=>[e(i,{label:"可领养",value:"ADOPTABLE"}),e(i,{label:"已领养",value:"ADOPTED"}),e(i,{label:"观察中",value:"OBSERVATION"}),e(i,{label:"治疗中",value:"TREATMENT"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(T,{gutter:20},{default:t(()=>[e(m,{span:12},{default:t(()=>[e(o,{label:"是否绝育"},{default:t(()=>[e(h,{modelValue:s.value.isSterilized,"onUpdate:modelValue":a[14]||(a[14]=l=>s.value.isSterilized=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(o,{label:"是否接种疫苗"},{default:t(()=>[e(h,{modelValue:s.value.isVaccinated,"onUpdate:modelValue":a[15]||(a[15]=l=>s.value.isVaccinated=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(o,{label:"健康状况",prop:"healthStatus"},{default:t(()=>[e(p,{modelValue:s.value.healthStatus,"onUpdate:modelValue":a[16]||(a[16]=l=>s.value.healthStatus=l),placeholder:"请描述健康状况"},null,8,["modelValue"])]),_:1}),e(o,{label:"性格特点",prop:"character"},{default:t(()=>[e(p,{modelValue:s.value.character,"onUpdate:modelValue":a[17]||(a[17]=l=>s.value.character=l),type:"textarea",rows:2,placeholder:"请描述性格特点"},null,8,["modelValue"])]),_:1}),e(o,{label:"猫咪描述",prop:"description"},{default:t(()=>[e(p,{modelValue:s.value.description,"onUpdate:modelValue":a[18]||(a[18]=l=>s.value.description=l),type:"textarea",rows:3,placeholder:"请输入猫咪描述"},null,8,["modelValue"])]),_:1}),e(o,{label:"常出没地点",prop:"rescueLocation"},{default:t(()=>[e(p,{modelValue:s.value.rescueLocation,"onUpdate:modelValue":a[19]||(a[19]=l=>s.value.rescueLocation=l),placeholder:"请输入常出没地点"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},na=ne(he,[["__scopeId","data-v-cf438f64"]]);export{na as default};
