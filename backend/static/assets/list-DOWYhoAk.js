import{_ as j}from"./index-59OIMCbR.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                         *//* empty css                    *//* empty css                        *//* empty css                    *//* empty css                       *//* empty css                        */import{r as _,l as tt,o as st,B as c,E as s,R as l,O as f,C as o,D as n,Q as i,M as et,y as $,K as B,a5 as F,az as at,z as d,u as h,G as ot,Y as nt}from"./vue-vendor-UlW9XFxV.js";import{P as lt,L as rt,l as it,x as dt,y as ut,Q as ct,W as _t,a8 as vt,z as pt,_ as mt,B as gt,al as ft,am as ht,m as Ct,ab as yt,ah as Et,J as R,r as bt,e as kt,a as M}from"./element-plus-5e6ZgU0u.js";import{g as Nt,a as At}from"./crowdfunding-Dg2TszRA.js";import"./utils-Yxd-MeZx.js";const zt={class:"crowdfunding-page"},wt={class:"hero-banner"},Dt={class:"container"},Lt={class:"hero-content"},Pt={class:"hero-stats"},St={class:"stat-item"},It={class:"stat-value"},Vt={class:"stat-item"},xt={class:"stat-value"},Tt={class:"stat-item"},$t={class:"stat-value"},Bt={class:"container main-content"},Ft={class:"filter-section"},Rt={class:"filter-right"},Mt={key:0,class:"hot-section"},Ot={class:"section-title"},Ut=["onClick"],Gt={class:"hot-image"},Ht={class:"hot-overlay"},Kt={class:"hot-info"},Qt={class:"description"},Wt={class:"progress-info"},Jt={class:"progress-stats"},Yt={class:"raised"},qt={class:"target"},Xt={class:"projects-section"},Zt={key:0,class:"section-title"},jt={class:"projects-grid"},ts=["onClick"],ss={class:"card-cover"},es={class:"image-error"},as={class:"card-overlay"},os={key:0,class:"days-left"},ns={class:"card-body"},ls={class:"card-title"},rs={class:"card-desc"},is={key:0,class:"related-cat"},ds={class:"progress-wrapper"},us={class:"card-stats"},cs={class:"stat"},_s={class:"value"},vs={class:"stat"},ps={class:"value"},ms={class:"stat"},gs={class:"value"},fs={class:"card-footer"},hs={class:"creator"},Cs={key:1,class:"pagination-wrapper"},ys={__name:"list",setup(Es){const D=at(),y=_(!1),v=_([]),E=_([]),p=_(""),b=_(!1),k=_(1),N=_(12),C=_(0),m=tt({totalProjects:0,totalRaised:0,totalSupporters:0}),A=async()=>{y.value=!0;try{const a={pageNum:k.value,pageSize:N.value};p.value&&(a.status=p.value),b.value&&(a.isEndingSoon=!0);const t=await Nt(a);t.code===200&&(v.value=t.data.records||[],C.value=t.data.total||0,m.totalProjects=C.value,m.totalRaised=v.value.reduce((r,u)=>r+Number(u.currentAmount||0),0),m.totalSupporters=v.value.reduce((r,u)=>r+Number(u.supporterCount||0),0))}catch(a){console.error("加载众筹项目失败",a),v.value=[],C.value=0}finally{y.value=!1}},O=async()=>{try{const a=await At(5);a.code===200&&(E.value=a.data||[])}catch{E.value=[]}},z=a=>{if(a.progress!=null)return Number(a.progress)||0;const t=Number(a.targetAmount||0),r=Number(a.currentAmount||0);return t?Math.min(Math.round(r/t*100),100):0},L=a=>{const t=z(a);return t>=100?"#67C23A":t>=60?"#E6A23C":"#409EFF"},U=a=>{if(a.remainingDays!=null){const u=Number(a.remainingDays);return Number.isFinite(u)?u<=0?"已结束":u===1?"最后1天":`剩${u}天`:"-"}const t=a.endDate;if(!t)return"-";const r=M(t).diff(M(),"day");return r<=0?"已结束":r===1?"最后1天":`剩${r}天`},G=a=>({DRAFT:"草稿",ACTIVE:"进行中",COMPLETED:"已完成",FAILED:"未达标",CANCELLED:"已取消"})[a]||a,w=a=>{const t=Number(a||0);return t?`¥${t.toLocaleString()}`:"¥0"},P=()=>{k.value=1,A()},S=a=>{D.push(`/crowdfunding/${a}`)},H=a=>{D.push(`/crowdfunding/${a.id}?action=donate`)};return st(()=>{A(),O()}),(a,t)=>{const r=_t,u=lt,K=rt,g=it,I=mt,Q=gt,V=ft,W=pt,J=dt,Y=Ct,x=bt,q=kt,X=ct,Z=ut;return d(),c("div",zt,[s("div",wt,[s("div",Dt,[s("div",Lt,[t[7]||(t[7]=s("h1",null,"爱心众筹",-1)),t[8]||(t[8]=s("p",null,"每一份爱心，都是猫咪重获新生的希望",-1)),s("div",Pt,[s("div",St,[s("span",It,l(m.totalProjects||0),1),t[4]||(t[4]=s("span",{class:"stat-label"},"众筹项目",-1))]),s("div",Vt,[s("span",xt,l(w(m.totalRaised)),1),t[5]||(t[5]=s("span",{class:"stat-label"},"累计筹款",-1))]),s("div",Tt,[s("span",$t,l(m.totalSupporters||0),1),t[6]||(t[6]=s("span",{class:"stat-label"},"爱心人士",-1))])])])])]),s("div",Bt,[s("div",Ft,[o(u,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),onChange:P,size:"large"},{default:n(()=>[o(r,{label:""},{default:n(()=>[...t[9]||(t[9]=[i("全部项目",-1)])]),_:1}),o(r,{label:"ACTIVE"},{default:n(()=>[...t[10]||(t[10]=[i("进行中",-1)])]),_:1}),o(r,{label:"COMPLETED"},{default:n(()=>[...t[11]||(t[11]=[i("已完成",-1)])]),_:1}),o(r,{label:"FAILED"},{default:n(()=>[...t[12]||(t[12]=[i("未达标",-1)])]),_:1}),o(r,{label:"CANCELLED"},{default:n(()=>[...t[13]||(t[13]=[i("已取消",-1)])]),_:1})]),_:1},8,["modelValue"]),s("div",Rt,[o(K,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=e=>b.value=e),onChange:P},{default:n(()=>[...t[14]||(t[14]=[i("只看即将结束",-1)])]),_:1},8,["modelValue"])])]),E.value.length>0&&!p.value&&!b.value?(d(),c("div",Mt,[s("h2",Ot,[o(g,null,{default:n(()=>[o(h(vt))]),_:1}),t[15]||(t[15]=i(" 热门众筹 ",-1))]),o(J,{interval:5e3,height:"280px","indicator-position":"outside"},{default:n(()=>[(d(!0),c(B,null,F(E.value,e=>(d(),$(W,{key:e.id},{default:n(()=>[s("div",{class:"hot-card",onClick:T=>S(e.id)},[s("div",Gt,[o(I,{src:e.coverImage,fit:"cover"},null,8,["src"]),s("div",Ht,[o(Q,{type:"danger",effect:"dark"},{default:n(()=>[...t[16]||(t[16]=[i("热门",-1)])]),_:1})])]),s("div",Kt,[s("h3",null,l(e.title),1),s("p",Qt,l(e.description),1),s("div",Wt,[o(V,{percentage:z(e),"stroke-width":8,color:L(e)},null,8,["percentage","color"]),s("div",Jt,[s("span",Yt,[t[17]||(t[17]=i("已筹 ",-1)),s("strong",null,l(w(e.currentAmount)),1)]),s("span",qt,"目标 "+l(w(e.targetAmount)),1)])])])],8,Ut)]),_:2},1024))),128))]),_:1})])):f("",!0),s("div",Xt,[p.value?f("",!0):(d(),c("h2",Zt,[o(g,null,{default:n(()=>[o(h(ht))]),_:1}),t[18]||(t[18]=i(" 全部项目 ",-1))])),et((d(),c("div",jt,[!y.value&&v.value.length===0?(d(),$(Y,{key:0,description:"暂无众筹项目"})):f("",!0),(d(!0),c(B,null,F(v.value,e=>(d(),c("div",{key:e.id,class:"project-card",onClick:T=>S(e.id)},[s("div",{class:ot(["status-badge",`status-${(e.status||"UNKNOWN").toLowerCase()}`])},l(G(e.status)),3),s("div",ss,[o(I,{src:e.coverImage,fit:"cover",lazy:""},{error:n(()=>[s("div",es,[o(g,{size:"40"},{default:n(()=>[o(h(yt))]),_:1})])]),_:1},8,["src"]),s("div",as,[e.status==="ACTIVE"?(d(),c("span",os,[o(g,null,{default:n(()=>[o(h(Et))]),_:1}),i(" "+l(U(e)),1)])):f("",!0)])]),s("div",ns,[s("h3",ls,l(e.title),1),s("p",rs,l(e.description),1),e.catId||e.catName?(d(),c("div",is,[o(x,{size:24,src:e.catCoverImage},{default:n(()=>[o(g,null,{default:n(()=>[o(h(R))]),_:1})]),_:1},8,["src"]),s("span",null,l(e.catName||"关联猫咪"),1)])):f("",!0),s("div",ds,[o(V,{percentage:z(e),"stroke-width":6,"show-text":!1,color:L(e)},null,8,["percentage","color"])]),s("div",us,[s("div",cs,[s("span",_s,l(w(e.currentAmount)),1),t[19]||(t[19]=s("span",{class:"label"},"已筹金额",-1))]),s("div",vs,[s("span",ps,l(e.supporterCount||0),1),t[20]||(t[20]=s("span",{class:"label"},"支持人数",-1))]),s("div",ms,[s("span",gs,l(z(e))+"%",1),t[21]||(t[21]=s("span",{class:"label"},"完成度",-1))])])]),s("div",fs,[s("div",hs,[o(x,{size:28,src:e.creatorAvatar},{default:n(()=>[o(g,null,{default:n(()=>[o(h(R))]),_:1})]),_:1},8,["src"]),s("span",null,l(e.creatorName||"匿名"),1)]),o(q,{type:"primary",size:"small",round:"",onClick:nt(T=>H(e),["stop"])},{default:n(()=>[...t[22]||(t[22]=[i(" 支持TA ",-1)])]),_:1},8,["onClick"])])],8,ts))),128))])),[[Z,y.value]]),C.value>N.value?(d(),c("div",Cs,[o(X,{"current-page":k.value,"onUpdate:currentPage":t[2]||(t[2]=e=>k.value=e),"page-size":N.value,"onUpdate:pageSize":t[3]||(t[3]=e=>N.value=e),total:C.value,"page-sizes":[12,24,36],layout:"total, sizes, prev, pager, next",onSizeChange:A,onCurrentChange:A},null,8,["current-page","page-size","total"])])):f("",!0)])])])}}},Fs=j(ys,[["__scopeId","data-v-23a2e8ef"]]);export{Fs as default};
