import{_ as Z}from"./index-59OIMCbR.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                             *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                *//* empty css                        *//* empty css                       *//* empty css                        */import{r as C,l as M,c as z,o as ee,B as m,E as n,C as l,M as te,D as s,y as v,O as c,K as ae,a5 as se,az as le,z as r,Q as o,R as u,G as oe}from"./vue-vendor-UlW9XFxV.js";import{g as ne,c as ie}from"./adoption-Cb5HDKbY.js";import{P as re,y as ue,Q as de,a6 as ce,E as A,m as pe,W as ve,b as me,e as _e,_ as ge,B as fe,Y as ye,a1 as Ee,a2 as Ce,a as De,a5 as ke}from"./element-plus-5e6ZgU0u.js";import"./utils-Yxd-MeZx.js";const be={class:"my-applications-page"},Ne={class:"container"},we={class:"filter-bar"},ze={class:"applications-list"},Ae={key:1,class:"application-cards"},Pe={class:"card-content"},Te=["onClick"],Re={class:"cat-image"},Ve={class:"cat-info"},Be={class:"cat-meta"},Ie={class:"application-section"},xe={class:"info-row"},Le={class:"value"},Me={class:"info-row"},$e={key:0,class:"info-row"},je={class:"value"},Ge={key:1,class:"info-row"},Se={class:"value comment"},Ue={class:"actions-section"},Je={key:2,class:"pagination-wrapper"},Oe={key:0,class:"detail-content"},Ye={__name:"my",setup(he){const P=le(),D=C(!1),k=C(""),d=M({page:1,size:10}),_=C([]),g=M({pending:0,approved:0,rejected:0,cancelled:0}),y=C(!1),i=C(null),T=async()=>{D.value=!0;try{const t=await ne();t.code===200&&(_.value=Array.isArray(t.data)?t.data:[],g.pending=_.value.filter(e=>e.status==="PENDING").length,g.approved=_.value.filter(e=>e.status==="APPROVED").length,g.rejected=_.value.filter(e=>e.status==="REJECTED").length,g.cancelled=_.value.filter(e=>e.status==="CANCELLED").length)}catch{A.error("加载申请列表失败")}finally{D.value=!1}},R=z(()=>k.value?_.value.filter(t=>t.status===k.value):_.value),V=z(()=>R.value.length),B=z(()=>{const t=(d.page-1)*d.size;return R.value.slice(t,t+d.size)}),$=()=>{d.page=1},j=t=>{d.page=t},G=t=>{d.size=t,d.page=1},S=t=>{i.value=t,y.value=!0},I=async t=>{try{await ke.confirm("确定要取消这个领养申请吗？取消后无法恢复。","取消确认",{confirmButtonText:"确定取消",cancelButtonText:"再想想",type:"warning"}),(await ie(t)).code===200&&(A.success("申请已取消"),T())}catch(e){e!=="cancel"&&A.error(e.message||"取消申请失败")}},U=async()=>{await I(i.value.id),y.value=!1},J=t=>{P.push(`/adoption/apply/${t}`)},O=t=>{P.push(`/cats/${t}`)},x=t=>({PENDING:"待审核",APPROVED:"已通过",REJECTED:"已拒绝",CANCELLED:"已取消"})[t]||t,L=t=>({PENDING:"warning",APPROVED:"success",REJECTED:"danger",CANCELLED:"info"})[t]||"info",b=t=>t?De(t).format("YYYY-MM-DD HH:mm:ss"):"-";return ee(()=>{T()}),(t,e)=>{const E=ve,Y=me,h=re,f=_e,F=pe,H=ge,w=fe,Q=ye,K=de,p=Ce,W=Ee,q=ce,X=ue;return r(),m("div",be,[n("div",Ne,[e[20]||(e[20]=n("div",{class:"page-header"},[n("h1",null,"我的领养申请"),n("p",{class:"desc"},"查看和管理您提交的领养申请")],-1)),n("div",we,[l(h,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=a=>k.value=a),onChange:$},{default:s(()=>[l(E,{label:""},{default:s(()=>[...e[6]||(e[6]=[o("全部",-1)])]),_:1}),l(E,{label:"PENDING"},{default:s(()=>[e[7]||(e[7]=o(" 待审核 ",-1)),g.pending>0?(r(),v(Y,{key:0,value:g.pending,class:"badge"},null,8,["value"])):c("",!0)]),_:1}),l(E,{label:"APPROVED"},{default:s(()=>[...e[8]||(e[8]=[o("已通过",-1)])]),_:1}),l(E,{label:"REJECTED"},{default:s(()=>[...e[9]||(e[9]=[o("已拒绝",-1)])]),_:1}),l(E,{label:"CANCELLED"},{default:s(()=>[...e[10]||(e[10]=[o("已取消",-1)])]),_:1})]),_:1},8,["modelValue"])]),te((r(),m("div",ze,[!D.value&&B.value.length===0?(r(),v(F,{key:0,description:"暂无申请记录"},{default:s(()=>[l(f,{type:"primary",onClick:e[1]||(e[1]=a=>t.$router.push("/cats"))},{default:s(()=>[...e[11]||(e[11]=[o(" 去看看猫咪 ",-1)])]),_:1})]),_:1})):(r(),m("div",Ae,[(r(!0),m(ae,null,se(B.value,a=>(r(),v(Q,{key:a.id,class:oe(["application-card",`status-${a.status.toLowerCase()}`])},{default:s(()=>[n("div",Pe,[n("div",{class:"cat-section",onClick:N=>O(a.catId)},[n("div",Re,[l(H,{src:a.catImage||"/placeholder-cat.jpg",fit:"cover",alt:a.catName},null,8,["src","alt"])]),n("div",Ve,[n("h3",null,u(a.catName),1),n("div",Be,[l(w,{size:"small",type:"info"},{default:s(()=>[...e[12]||(e[12]=[o("猫咪档案",-1)])]),_:1})])])],8,Te),n("div",Ie,[n("div",xe,[e[13]||(e[13]=n("span",{class:"label"},"申请时间：",-1)),n("span",Le,u(b(a.createTime)),1)]),n("div",Me,[e[14]||(e[14]=n("span",{class:"label"},"申请状态：",-1)),l(w,{type:L(a.status),size:"small"},{default:s(()=>[o(u(x(a.status)),1)]),_:2},1032,["type"])]),a.reviewTime?(r(),m("div",$e,[e[15]||(e[15]=n("span",{class:"label"},"审核时间：",-1)),n("span",je,u(b(a.reviewTime)),1)])):c("",!0),a.rejectReason?(r(),m("div",Ge,[e[16]||(e[16]=n("span",{class:"label"},"拒绝理由：",-1)),n("span",Se,u(a.rejectReason),1)])):c("",!0)]),n("div",Ue,[l(f,{type:"primary",plain:"",size:"small",onClick:N=>S(a)},{default:s(()=>[...e[17]||(e[17]=[o(" 查看详情 ",-1)])]),_:1},8,["onClick"]),a.status==="PENDING"?(r(),v(f,{key:0,type:"danger",plain:"",size:"small",onClick:N=>I(a.id)},{default:s(()=>[...e[18]||(e[18]=[o(" 取消申请 ",-1)])]),_:1},8,["onClick"])):c("",!0),a.status==="REJECTED"?(r(),v(f,{key:1,type:"warning",plain:"",size:"small",onClick:N=>J(a.catId)},{default:s(()=>[...e[19]||(e[19]=[o(" 重新申请 ",-1)])]),_:1},8,["onClick"])):c("",!0)])])]),_:2},1032,["class"]))),128))])),V.value>0?(r(),m("div",Je,[l(K,{"current-page":d.page,"onUpdate:currentPage":e[2]||(e[2]=a=>d.page=a),"page-size":d.size,"onUpdate:pageSize":e[3]||(e[3]=a=>d.size=a),total:V.value,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:G,onCurrentChange:j},null,8,["current-page","page-size","total"])])):c("",!0)])),[[X,D.value]])]),l(q,{modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=a=>y.value=a),title:"申请详情",width:"600px","close-on-click-modal":!1},{footer:s(()=>{var a;return[l(f,{onClick:e[4]||(e[4]=N=>y.value=!1)},{default:s(()=>[...e[21]||(e[21]=[o("关闭",-1)])]),_:1}),((a=i.value)==null?void 0:a.status)==="PENDING"?(r(),v(f,{key:0,type:"danger",onClick:U},{default:s(()=>[...e[22]||(e[22]=[o(" 取消申请 ",-1)])]),_:1})):c("",!0)]}),default:s(()=>[i.value?(r(),m("div",Oe,[l(W,{column:1,border:""},{default:s(()=>[l(p,{label:"领养理由"},{default:s(()=>[o(u(i.value.reason),1)]),_:1}),l(p,{label:"居住条件"},{default:s(()=>[o(u(i.value.livingCondition),1)]),_:1}),l(p,{label:"养猫经验"},{default:s(()=>[o(u(i.value.experience),1)]),_:1}),l(p,{label:"联系电话"},{default:s(()=>[o(u(i.value.contactPhone),1)]),_:1}),l(p,{label:"联系地址"},{default:s(()=>[o(u(i.value.contactAddress),1)]),_:1}),l(p,{label:"申请时间"},{default:s(()=>[o(u(b(i.value.createTime)),1)]),_:1}),l(p,{label:"申请状态"},{default:s(()=>[l(w,{type:L(i.value.status)},{default:s(()=>[o(u(x(i.value.status)),1)]),_:1},8,["type"])]),_:1}),i.value.reviewTime?(r(),v(p,{key:0,label:"审核时间"},{default:s(()=>[o(u(b(i.value.reviewTime)),1)]),_:1})):c("",!0),i.value.reviewUserName?(r(),v(p,{key:1,label:"审核人"},{default:s(()=>[o(u(i.value.reviewUserName),1)]),_:1})):c("",!0),i.value.rejectReason?(r(),v(p,{key:2,label:"拒绝理由"},{default:s(()=>[o(u(i.value.rejectReason),1)]),_:1})):c("",!0)]),_:1})])):c("",!0)]),_:1},8,["modelValue"])])}}},ut=Z(Ye,[["__scopeId","data-v-c13ec839"]]);export{ut as default};
