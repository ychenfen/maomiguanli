import{_ as H,s as P}from"./index-59OIMCbR.js";/* empty css                   *//* empty css                     *//* empty css                 *//* empty css                  *//* empty css                   *//* empty css                             *//* empty css                *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";import{Y as Q,a6 as q,ar as K,as as Y,B as W,e as X,y as Z,Q as ee,S as ae,T as te,a1 as le,a2 as oe,F as ne,H as se,I as ie,a5 as ue,E as f}from"./element-plus-5e6ZgU0u.js";import{r as u,w as re,o as pe,B as R,C as e,D as t,z as V,M as de,y as ce,Q as n,R as i,O as me,K as ve,E as I}from"./vue-vendor-UlW9XFxV.js";import"./utils-Yxd-MeZx.js";const _e={class:"adoption-manage"},fe={class:"card-header"},Ee={__name:"adoptions",setup(ge){const b=u(!1),m=u([]),E=u(""),g=u(1),C=u(10),D=u(0),N=u(!1),v=u(!1),s=u({}),d=u({id:null,reason:""}),x=o=>({PENDING:"warning",APPROVED:"success",REJECTED:"danger",CANCELLED:"info"})[o]||"info",w=o=>({PENDING:"待审核",APPROVED:"已通过",REJECTED:"已拒绝",CANCELLED:"已取消"})[o]||o,_=async()=>{b.value=!0;try{const o=await P.get("/adoption-applications/page",{params:{pageNum:g.value,pageSize:C.value,status:E.value||void 0}});o.code===200&&(m.value=o.data.records||o.data,D.value=o.data.total||m.value.length)}catch{m.value=[{id:1,catName:"橘子",userName:"王五",contactPhone:"13800138003",contactAddress:"海淀区学院路小区",reason:"我非常喜欢橘猫，承诺会好好照顾它。",livingCondition:"独立住房，有阳台，已安装纱窗",experience:"之前养过一只猫5年",status:"PENDING",createTime:"2024-12-24 12:00:00"},{id:2,catName:"小黑",userName:"孙七",contactPhone:"13800138005",contactAddress:"朝阳区望京SOHO",reason:"看到小黑的照片就被吸引了。",livingCondition:"合租公寓，室友同意养猫",experience:"家里养过猫",status:"PENDING",createTime:"2024-12-24 14:00:00"},{id:3,catName:"咪咪",userName:"王五",contactPhone:"13800138003",contactAddress:"海淀区五道口",reason:"咪咪太可爱了，希望能领养它。",livingCondition:"独立住房",experience:"有3年养猫经验",status:"APPROVED",createTime:"2024-09-01 10:00:00"},{id:4,catName:"奶牛",userName:"孙七",contactPhone:"13800138005",contactAddress:"朝阳区三里屯",reason:"奶牛的花色太好看了。",livingCondition:"独立公寓",experience:"有养猫经验",status:"REJECTED",createTime:"2024-10-20 09:00:00"}],D.value=m.value.length}finally{b.value=!1}},O=o=>{s.value=o,N.value=!0},z=async o=>{try{await ue.confirm(`确定通过 "${o.realName||o.username}" 对猫咪 "${o.catName}" 的领养申请吗？`,"确认",{type:"success"}),await P.post(`/adoption-applications/${o.id}/review`,null,{params:{status:"APPROVED"}}),f.success("审核通过"),_()}catch(a){a!=="cancel"&&(o.status="APPROVED",f.success("审核通过（模拟）"))}},S=o=>{d.value={id:o.id,reason:""},v.value=!0},$=async()=>{if(!d.value.reason){f.warning("请输入拒绝原因");return}try{await P.post(`/adoption-applications/${d.value.id}/review`,null,{params:{status:"REJECTED",rejectReason:d.value.reason}}),f.success("已拒绝")}catch{f.success("已拒绝（模拟）")}v.value=!1,_()};return re(E,()=>{g.value=1,_()}),pe(()=>{_()}),(o,a)=>{const y=te,B=ae,p=Y,T=W,c=X,h=K,j=ee,F=Q,r=oe,G=le,k=q,U=ie,J=se,L=ne,M=Z;return V(),R("div",_e,[e(F,null,{header:t(()=>[I("div",fe,[a[8]||(a[8]=I("span",null,"领养审核",-1)),e(B,{modelValue:E.value,"onUpdate:modelValue":a[0]||(a[0]=l=>E.value=l),placeholder:"状态筛选",clearable:"",style:{width:"120px"}},{default:t(()=>[e(y,{label:"待审核",value:"PENDING"}),e(y,{label:"已通过",value:"APPROVED"}),e(y,{label:"已拒绝",value:"REJECTED"})]),_:1},8,["modelValue"])])]),default:t(()=>[de((V(),ce(h,{data:m.value,style:{width:"100%"}},{default:t(()=>[e(p,{prop:"id",label:"ID",width:"60"}),e(p,{prop:"catName",label:"猫咪",width:"100"}),e(p,{label:"申请人",width:"120"},{default:t(({row:l})=>[n(i(l.realName||l.username||"-"),1)]),_:1}),e(p,{prop:"contactPhone",label:"联系电话",width:"130"}),e(p,{prop:"reason",label:"领养理由","show-overflow-tooltip":""}),e(p,{prop:"status",label:"状态",width:"100"},{default:t(({row:l})=>[e(T,{type:x(l.status)},{default:t(()=>[n(i(w(l.status)),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"createTime",label:"申请时间",width:"160"}),e(p,{label:"操作",fixed:"right",width:"200"},{default:t(({row:l})=>[l.status==="PENDING"?(V(),R(ve,{key:0},[e(c,{type:"success",link:"",size:"small",onClick:A=>z(l)},{default:t(()=>[...a[9]||(a[9]=[n("通过",-1)])]),_:1},8,["onClick"]),e(c,{type:"danger",link:"",size:"small",onClick:A=>S(l)},{default:t(()=>[...a[10]||(a[10]=[n("拒绝",-1)])]),_:1},8,["onClick"])],64)):me("",!0),e(c,{type:"primary",link:"",size:"small",onClick:A=>O(l)},{default:t(()=>[...a[11]||(a[11]=[n("详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[M,b.value]]),e(j,{"current-page":g.value,"onUpdate:currentPage":a[1]||(a[1]=l=>g.value=l),"page-size":C.value,"onUpdate:pageSize":a[2]||(a[2]=l=>C.value=l),total:D.value,layout:"total, prev, pager, next",style:{"margin-top":"20px","justify-content":"flex-end"},onCurrentChange:_},null,8,["current-page","page-size","total"])]),_:1}),e(k,{modelValue:N.value,"onUpdate:modelValue":a[4]||(a[4]=l=>N.value=l),title:"申请详情",width:"600px"},{footer:t(()=>[e(c,{onClick:a[3]||(a[3]=l=>N.value=!1)},{default:t(()=>[...a[12]||(a[12]=[n("关闭",-1)])]),_:1})]),default:t(()=>[e(G,{column:2,border:""},{default:t(()=>[e(r,{label:"猫咪名称"},{default:t(()=>[n(i(s.value.catName),1)]),_:1}),e(r,{label:"申请人"},{default:t(()=>[n(i(s.value.realName||s.value.username),1)]),_:1}),e(r,{label:"联系电话"},{default:t(()=>[n(i(s.value.contactPhone),1)]),_:1}),e(r,{label:"联系地址"},{default:t(()=>[n(i(s.value.contactAddress),1)]),_:1}),e(r,{label:"领养理由",span:2},{default:t(()=>[n(i(s.value.reason),1)]),_:1}),e(r,{label:"居住条件",span:2},{default:t(()=>[n(i(s.value.livingCondition),1)]),_:1}),e(r,{label:"养猫经验",span:2},{default:t(()=>[n(i(s.value.experience),1)]),_:1}),e(r,{label:"申请时间"},{default:t(()=>[n(i(s.value.createTime),1)]),_:1}),e(r,{label:"状态"},{default:t(()=>[e(T,{type:x(s.value.status)},{default:t(()=>[n(i(w(s.value.status)),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(k,{modelValue:v.value,"onUpdate:modelValue":a[7]||(a[7]=l=>v.value=l),title:"拒绝申请",width:"400px"},{footer:t(()=>[e(c,{onClick:a[6]||(a[6]=l=>v.value=!1)},{default:t(()=>[...a[13]||(a[13]=[n("取消",-1)])]),_:1}),e(c,{type:"danger",onClick:$},{default:t(()=>[...a[14]||(a[14]=[n("确认拒绝",-1)])]),_:1})]),default:t(()=>[e(L,{model:d.value,"label-width":"80px"},{default:t(()=>[e(J,{label:"拒绝原因",required:""},{default:t(()=>[e(U,{modelValue:d.value.reason,"onUpdate:modelValue":a[5]||(a[5]=l=>d.value.reason=l),type:"textarea",rows:4,placeholder:"请输入拒绝原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},$e=H(Ee,[["__scopeId","data-v-819cd725"]]);export{$e as default};
